<!doctype html>
<html lang="en"> 
 <head> 
  <meta charset="UTF-8"> 
  <title>Execution Trace Diff</title> 
  <meta name="viewport" content="width=device-width, initial-scale=1"> 
  <style>
* {
  box-sizing: border-box;
}

/* Create two equal columns that floats next to each other */
.column {
  float: left;
  width: 50%;
  padding: 10px;
  height: 300px; /* Should be removed. Only for demonstration */
}

/* Clear floats after the columns */
.row:after {
  content: "";
  display: table;
  clear: both;
}

.test {
    border: 1px solid darkblue;
    padding-left: 10px;
}
</style> 
 </head> 
 <body> 
  <div class="row test"> 
   <h2>Differencing Test:</h2> <code> <pre>@Test <br>
public void test_main(){ <br>
    String ret = NumberAnalyzer.analyze(1); <br>
    assertThat(ret, containsString("greater")); <br>
}
        </pre> </code> 
  </div> 
  <div class="row"> 
   <div class="column"> 
    <h2>Original Code:</h2> <code> <pre id="original-trace">           1:  <span style="background-color: white">      /*</span><br>           2:  <span style="background-color: white">       * {{{ header &amp; license</span><br>           3:  <span style="background-color: white">       * Copyright (c) 2004, 2005 Joshua Marinacci, Torbjoern Gannholm</span><br>           4:  <span style="background-color: white">       *</span><br>           5:  <span style="background-color: white">       * This program is free software; you can redistribute it and/or</span><br>           6:  <span style="background-color: white">       * modify it under the terms of the GNU Lesser General Public License</span><br>           7:  <span style="background-color: white">       * as published by the Free Software Foundation; either version 2.1</span><br>           8:  <span style="background-color: white">       * of the License, or (at your option) any later version.</span><br>           9:  <span style="background-color: white">       *</span><br>          10:  <span style="background-color: white">       * This program is distributed in the hope that it will be useful,</span><br>          11:  <span style="background-color: white">       * but WITHOUT ANY WARRANTY; without even the implied warranty of</span><br>          12:  <span style="background-color: white">       * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.	See the</span><br>          13:  <span style="background-color: white">       * GNU Lesser General Public License for more details.</span><br>          14:  <span style="background-color: white">       *</span><br>          15:  <span style="background-color: white">       * You should have received a copy of the GNU Lesser General Public License</span><br>          16:  <span style="background-color: white">       * along with this program; if not, write to the Free Software</span><br>          17:  <span style="background-color: white">       * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.</span><br>          18:  <span style="background-color: white">       * }}}</span><br>          19:  <span style="background-color: white">       */</span><br>          20:  <span style="background-color: white">      package com.openhtmltopdf.layout;</span><br>          21:  <span style="background-color: white">      </span><br>          22:  <span style="background-color: white">      import java.awt.Rectangle;</span><br>          23:  <span style="background-color: white">      import java.util.ArrayList;</span><br>          24:  <span style="background-color: white">      import java.util.HashMap;</span><br>          25:  <span style="background-color: white">      import java.util.LinkedList;</span><br>          26:  <span style="background-color: white">      import java.util.List;</span><br>          27:  <span style="background-color: white">      import java.util.Map;</span><br>          28:  <span style="background-color: white">      </span><br>          29:  <span style="background-color: white">      import com.openhtmltopdf.bidi.BidiReorderer;</span><br>          30:  <span style="background-color: white">      import com.openhtmltopdf.bidi.BidiSplitter;</span><br>          31:  <span style="background-color: white">      import com.openhtmltopdf.bidi.BidiSplitterFactory;</span><br>          32:  <span style="background-color: white">      import com.openhtmltopdf.bidi.ParagraphSplitter;</span><br>          33:  <span style="background-color: white">      import com.openhtmltopdf.bidi.SimpleBidiReorderer;</span><br>          34:  <span style="background-color: white">      import com.openhtmltopdf.bidi.SimpleBidiSplitterFactory;</span><br>          35:  <span style="background-color: white">      import com.openhtmltopdf.context.ContentFunctionFactory;</span><br>          36:  <span style="background-color: white">      import com.openhtmltopdf.context.StyleReference;</span><br>          37:  <span style="background-color: white">      import com.openhtmltopdf.css.constants.CSSName;</span><br>          38:  <span style="background-color: white">      import com.openhtmltopdf.css.constants.IdentValue;</span><br>          39:  <span style="background-color: white">      import com.openhtmltopdf.css.parser.CounterData;</span><br>          40:  <span style="background-color: white">      import com.openhtmltopdf.css.style.CalculatedStyle;</span><br>          41:  <span style="background-color: white">      import com.openhtmltopdf.css.style.CssContext;</span><br>          42:  <span style="background-color: white">      import com.openhtmltopdf.css.value.FontSpecification;</span><br>          43:  <span style="background-color: white">      import com.openhtmltopdf.extend.FSCanvas;</span><br>          44:  <span style="background-color: white">      import com.openhtmltopdf.extend.FontContext;</span><br>          45:  <span style="background-color: white">      import com.openhtmltopdf.extend.NamespaceHandler;</span><br>          46:  <span style="background-color: white">      import com.openhtmltopdf.extend.ReplacedElementFactory;</span><br>          47:  <span style="background-color: white">      import com.openhtmltopdf.extend.TextRenderer;</span><br>          48:  <span style="background-color: white">      import com.openhtmltopdf.extend.UserAgentCallback;</span><br>          49:  <span style="background-color: white">      import com.openhtmltopdf.render.Box;</span><br>          50:  <span style="background-color: white">      import com.openhtmltopdf.render.FSFont;</span><br>          51:  <span style="background-color: white">      import com.openhtmltopdf.render.FSFontMetrics;</span><br>          52:  <span style="background-color: white">      import com.openhtmltopdf.render.MarkerData;</span><br>          53:  <span style="background-color: white">      import com.openhtmltopdf.render.PageBox;</span><br>          54:  <span style="background-color: white">      </span><br>          55:  <span style="background-color: white">      /**</span><br>          56:  <span style="background-color: white">       * This class tracks state which changes over the course of a layout run.</span><br>          57:  <span style="background-color: white">       * Generally speaking, if possible, state information should be stored in the box</span><br>          58:  <span style="background-color: white">       * tree and not here.  It also provides pass-though calls to many methods in</span><br>          59:  <span style="background-color: white">       * {@link SharedContext}.</span><br>          60:  <span style="background-color: white">       */</span><br>          61:  <span style="background-color: white">      public class LayoutContext implements CssContext {</span><br>          62:  <span style="background-color: white">          private SharedContext _sharedContext;</span><br>          63:  <span style="background-color: white">      </span><br>          64:  <span style="background-color: white">          private Layer _rootLayer;</span><br>          65:  <span style="background-color: white">      </span><br>          66:  <span style="background-color: white">          private StyleTracker _firstLines;</span><br>          67:  <span style="background-color: white">          private StyleTracker _firstLetters;</span><br>          68:  <span style="background-color: white">          private MarkerData _currentMarkerData;</span><br>          69:  <span style="background-color: white">      </span><br>          70:  <span style="background-color: white">          private LinkedList
       <blockformattingcontext>
         _bfcs;
       </blockformattingcontext></span><br>          71:  <span style="background-color: white">          private LinkedList
       <layer>
         _layers;
       </layer></span><br>          72:  <span style="background-color: white">      </span><br>          73:  <span style="background-color: white">          private FontContext _fontContext;</span><br>          74:  <span style="background-color: white">      </span><br>          75:  <span style="background-color: white">          private final ContentFunctionFactory _contentFunctionFactory = new ContentFunctionFactory();</span><br>          76:  <span style="background-color: white">      </span><br>          77:  <span style="background-color: white">          private int _extraSpaceTop;</span><br>          78:  <span style="background-color: white">          private int _extraSpaceBottom;</span><br>          79:  <span style="background-color: white">      </span><br>          80:  <span style="background-color: yellow">          private final Map
       <calculatedstyle, countercontext>
         _counterContextMap = new HashMap&lt;&gt;();
       </calculatedstyle,></span><br>          81:  <span style="background-color: white">      </span><br>          82:  <span style="background-color: white">          private String _pendingPageName;</span><br>          83:  <span style="background-color: white">          private String _pageName;</span><br>          84:  <span style="background-color: white">      </span><br>          85:  <span style="background-color: white">          private int _noPageBreak = 0;</span><br>          86:  <span style="background-color: white">      </span><br>          87:  <span style="background-color: white">          private Layer _rootDocumentLayer;</span><br>          88:  <span style="background-color: white">          private PageBox _page;</span><br>          89:  <span style="background-color: white">      </span><br>          90:  <span style="background-color: white">          private boolean _mayCheckKeepTogether = true;</span><br>          91:  <span style="background-color: white">      </span><br>          92:  <span style="background-color: white">          private boolean _lineBreakedBecauseOfNoWrap = false;</span><br>          93:  <span style="background-color: white">      </span><br>          94:  <span style="background-color: white">          private BreakAtLineContext _breakAtLineContext;</span><br>          95:  <span style="background-color: white">          </span><br>          96:  <span style="background-color: white">          private Boolean isPrintOverride = null; // True, false, or null for no override.</span><br>          97:  <span style="background-color: white">      </span><br>          98:  <span style="background-color: white">          @Override</span><br>          99:  <span style="background-color: white">          public TextRenderer getTextRenderer() {</span><br>         100:  <span style="background-color: white">              return _sharedContext.getTextRenderer();</span><br>         101:  <span style="background-color: white">          }</span><br>         102:  <span style="background-color: white">      </span><br>         103:  <span style="background-color: white">          public StyleReference getCss() {</span><br>         104:  <span style="background-color: white">              return _sharedContext.getCss();</span><br>         105:  <span style="background-color: white">          }</span><br>         106:  <span style="background-color: white">      </span><br>         107:  <span style="background-color: white">          public FSCanvas getCanvas() {</span><br>         108:  <span style="background-color: white">              return _sharedContext.getCanvas();</span><br>         109:  <span style="background-color: white">          }</span><br>         110:  <span style="background-color: white">      </span><br>         111:  <span style="background-color: white">          public Rectangle getFixedRectangle() {</span><br>         112:  <span style="background-color: white">              return _sharedContext.getFixedRectangle();</span><br>         113:  <span style="background-color: white">          }</span><br>         114:  <span style="background-color: white">      </span><br>         115:  <span style="background-color: white">          public NamespaceHandler getNamespaceHandler() {</span><br>         116:  <span style="background-color: white">              return _sharedContext.getNamespaceHandler();</span><br>         117:  <span style="background-color: white">          }</span><br>         118:  <span style="background-color: white">          </span><br>         119:  <span style="background-color: white">          private final ParagraphSplitter _splitter = new ParagraphSplitter();</span><br>         120:  <span style="background-color: white">          private BidiSplitterFactory _bidiSplitterFactory = new SimpleBidiSplitterFactory();</span><br>         121:  <span style="background-color: white">          private byte _defaultTextDirection = BidiSplitter.LTR;</span><br>         122:  <span style="background-color: white">          </span><br>         123:  <span style="background-color: white">          /**</span><br>         124:  <span style="background-color: white">           * The paragraph splitter splits the document into paragraphs for the purpose of bi-directional</span><br>         125:  <span style="background-color: white">           * text analysis.</span><br>         126:  <span style="background-color: white">           */</span><br>         127:  <span style="background-color: white">          public ParagraphSplitter getParagraphSplitter() {</span><br>         128:  <span style="background-color: white">          	return _splitter;</span><br>         129:  <span style="background-color: white">          }</span><br>         130:  <span style="background-color: white">          </span><br>         131:  <span style="background-color: white">          private BidiReorderer _bidiReorderer = new SimpleBidiReorderer();</span><br>         132:  <span style="background-color: white">          </span><br>         133:  <span style="background-color: white">          public void setBidiReorderer(BidiReorderer reorderer) {</span><br>         134:  <span style="background-color: white">          	_bidiReorderer = reorderer;</span><br>         135:  <span style="background-color: white">          }</span><br>         136:  <span style="background-color: white">          </span><br>         137:  <span style="background-color: white">          public BidiReorderer getBidiReorderer() {</span><br>         138:  <span style="background-color: white">          	return _bidiReorderer;</span><br>         139:  <span style="background-color: white">          }</span><br>         140:  <span style="background-color: white">          </span><br>         141:  <span style="background-color: white">          /**</span><br>         142:  <span style="background-color: white">           * The bidi splitter is used to split text runs into LTR and RTL visual ordering.</span><br>         143:  <span style="background-color: white">           */</span><br>         144:  <span style="background-color: white">          public BidiSplitterFactory getBidiSplitterFactory() {</span><br>         145:  <span style="background-color: white">          	return this._bidiSplitterFactory;</span><br>         146:  <span style="background-color: white">          }</span><br>         147:  <span style="background-color: white">          </span><br>         148:  <span style="background-color: white">          /**</span><br>         149:  <span style="background-color: white">           * The bidi splitter is used to split text runs into LTR and RTL visual ordering.</span><br>         150:  <span style="background-color: white">           */</span><br>         151:  <span style="background-color: white">          public void setBidiSplitterFactory(BidiSplitterFactory factory) {</span><br>         152:  <span style="background-color: white">          	this._bidiSplitterFactory = factory;</span><br>         153:  <span style="background-color: white">          }</span><br>         154:  <span style="background-color: white">          </span><br>         155:  <span style="background-color: white">          /**</span><br>         156:  <span style="background-color: white">           * @return the default text direction for a document.</span><br>         157:  <span style="background-color: white">           */</span><br>         158:  <span style="background-color: white">          public byte getDefaultTextDirection() {</span><br>         159:  <span style="background-color: white">          	return _defaultTextDirection;</span><br>         160:  <span style="background-color: white">          }</span><br>         161:  <span style="background-color: white">          </span><br>         162:  <span style="background-color: white">          /**</span><br>         163:  <span style="background-color: white">           * @param direction either BidiSplitter.LTR or BidiSplitter.RTL.</span><br>         164:  <span style="background-color: white">           */</span><br>         165:  <span style="background-color: white">          public void setDefaultTextDirection(byte direction) {</span><br>         166:  <span style="background-color: white">          	this._defaultTextDirection = direction;</span><br>         167:  <span style="background-color: white">          }</span><br>         168:  <span style="background-color: white">          </span><br>         169:  <span style="background-color: white">          //the stuff that needs to have a separate instance for each run.</span><br>         170:  <span style="background-color: yellow">          LayoutContext(SharedContext sharedContext) {</span><br>         171:  <span style="background-color: yellow">              _sharedContext = sharedContext;</span><br>         172:  <span style="background-color: yellow">              </span><br>         173:  <span style="background-color: yellow">              _bfcs = new LinkedList&lt;&gt;();</span><br>         174:  <span style="background-color: yellow">              _layers = new LinkedList&lt;&gt;();</span><br>         175:  <span style="background-color: yellow">      </span><br>         176:  <span style="background-color: yellow">              _firstLines = new StyleTracker();</span><br>         177:  <span style="background-color: yellow">              _firstLetters = new StyleTracker();</span><br>         178:  <span style="background-color: yellow">          }</span><br>         179:  <span style="background-color: white">      </span><br>         180:  <span style="background-color: white">          public void reInit(boolean keepLayers) {</span><br>         181:  <span style="background-color: yellow">              _firstLines = new StyleTracker();</span><br>         182:  <span style="background-color: yellow">              _firstLetters = new StyleTracker();</span><br>         183:  <span style="background-color: white">              _currentMarkerData = null;</span><br>         184:  <span style="background-color: white">      </span><br>         185:  <span style="background-color: white">              _bfcs = new LinkedList&lt;&gt;();</span><br>         186:  <span style="background-color: white">      </span><br>         187:  <span style="background-color: white">              if (! keepLayers) {</span><br>         188:  <span style="background-color: white">                  _rootLayer = null;</span><br>         189:  <span style="background-color: white">                  _layers = new LinkedList&lt;&gt;();</span><br>         190:  <span style="background-color: white">              }</span><br>         191:  <span style="background-color: white">      </span><br>         192:  <span style="background-color: white">              _extraSpaceTop = 0;</span><br>         193:  <span style="background-color: white">              _extraSpaceBottom = 0;</span><br>         194:  <span style="background-color: white">          }</span><br>         195:  <span style="background-color: white">      </span><br>         196:  <span style="background-color: yellow">          public LayoutState captureLayoutState() {</span><br>         197:  <span style="background-color: yellow">              LayoutState result = new LayoutState();</span><br>         198:  <span style="background-color: yellow">      </span><br>         199:  <span style="background-color: yellow">              result.setFirstLines(_firstLines);</span><br>         200:  <span style="background-color: yellow">              result.setFirstLetters(_firstLetters);</span><br>         201:  <span style="background-color: yellow">              result.setCurrentMarkerData(_currentMarkerData);</span><br>         202:  <span style="background-color: yellow">      </span><br>         203:  <span style="background-color: yellow">              result.setBFCs(_bfcs);</span><br>         204:  <span style="background-color: yellow">      </span><br>         205:  <span style="background-color: yellow">              if (isPrint()) {</span><br>         206:  <span style="background-color: yellow">                  result.setPageName(getPageName());</span><br>         207:  <span style="background-color: yellow">                  result.setExtraSpaceBottom(getExtraSpaceBottom());</span><br>         208:  <span style="background-color: yellow">                  result.setExtraSpaceTop(getExtraSpaceTop());</span><br>         209:  <span style="background-color: yellow">                  result.setNoPageBreak(getNoPageBreak());</span><br>         210:  <span style="background-color: yellow">              }</span><br>         211:  <span style="background-color: yellow">      </span><br>         212:  <span style="background-color: yellow">              return result;</span><br>         213:  <span style="background-color: yellow">          }</span><br>         214:  <span style="background-color: white">      </span><br>         215:  <span style="background-color: white">          public void restoreLayoutState(LayoutState layoutState) {</span><br>         216:  <span style="background-color: white">              _firstLines = layoutState.getFirstLines();</span><br>         217:  <span style="background-color: white">              _firstLetters = layoutState.getFirstLetters();</span><br>         218:  <span style="background-color: white">      </span><br>         219:  <span style="background-color: white">              _currentMarkerData = layoutState.getCurrentMarkerData();</span><br>         220:  <span style="background-color: white">      </span><br>         221:  <span style="background-color: white">              _bfcs = layoutState.getBFCs();</span><br>         222:  <span style="background-color: white">      </span><br>         223:  <span style="background-color: white">              if (isPrint()) {</span><br>         224:  <span style="background-color: white">                  setPageName(layoutState.getPageName());</span><br>         225:  <span style="background-color: white">                  setExtraSpaceBottom(layoutState.getExtraSpaceBottom());</span><br>         226:  <span style="background-color: white">                  setExtraSpaceTop(layoutState.getExtraSpaceTop());</span><br>         227:  <span style="background-color: white">                  setNoPageBreak(layoutState.getNoPageBreak());</span><br>         228:  <span style="background-color: white">              }</span><br>         229:  <span style="background-color: white">          }</span><br>         230:  <span style="background-color: white">      </span><br>         231:  <span style="background-color: yellow">          public LayoutState copyStateForRelayout() {</span><br>         232:  <span style="background-color: yellow">              LayoutState result = new LayoutState();</span><br>         233:  <span style="background-color: yellow">      </span><br>         234:  <span style="background-color: yellow">              result.setFirstLetters(_firstLetters.copyOf());</span><br>         235:  <span style="background-color: yellow">              result.setFirstLines(_firstLines.copyOf());</span><br>         236:  <span style="background-color: yellow">              result.setCurrentMarkerData(_currentMarkerData);</span><br>         237:  <span style="background-color: yellow">      </span><br>         238:  <span style="background-color: yellow">              if (isPrint()) {</span><br>         239:  <span style="background-color: yellow">                  result.setPageName(getPageName());</span><br>         240:  <span style="background-color: yellow">              }</span><br>         241:  <span style="background-color: yellow">      </span><br>         242:  <span style="background-color: yellow">              return result;</span><br>         243:  <span style="background-color: yellow">          }</span><br>         244:  <span style="background-color: white">      </span><br>         245:  <span style="background-color: white">          public void restoreStateForRelayout(LayoutState layoutState) {</span><br>         246:  <span style="background-color: white">              _firstLines = layoutState.getFirstLines();</span><br>         247:  <span style="background-color: white">              _firstLetters = layoutState.getFirstLetters();</span><br>         248:  <span style="background-color: white">      </span><br>         249:  <span style="background-color: white">              _currentMarkerData = layoutState.getCurrentMarkerData();</span><br>         250:  <span style="background-color: white">      </span><br>         251:  <span style="background-color: white">              if (isPrint()) {</span><br>         252:  <span style="background-color: white">                  setPageName(layoutState.getPageName());</span><br>         253:  <span style="background-color: white">              }</span><br>         254:  <span style="background-color: white">          }</span><br>         255:  <span style="background-color: white">      </span><br>         256:  <span style="background-color: white">          public BlockFormattingContext getBlockFormattingContext() {</span><br>         257:  <span style="background-color: white">              return _bfcs.getLast();</span><br>         258:  <span style="background-color: white">          }</span><br>         259:  <span style="background-color: white">      </span><br>         260:  <span style="background-color: white">          public void pushBFC(BlockFormattingContext bfc) {</span><br>         261:  <span style="background-color: white">              _bfcs.add(bfc);</span><br>         262:  <span style="background-color: white">          }</span><br>         263:  <span style="background-color: white">      </span><br>         264:  <span style="background-color: white">          public void popBFC() {</span><br>         265:  <span style="background-color: white">              _bfcs.removeLast();</span><br>         266:  <span style="background-color: white">          }</span><br>         267:  <span style="background-color: white">      </span><br>         268:  <span style="background-color: white">          public void pushLayer(Box master) {</span><br>         269:  <span style="background-color: white">              Layer layer = null;</span><br>         270:  <span style="background-color: white">      </span><br>         271:  <span style="background-color: white">              if (_rootLayer == null) {</span><br>         272:  <span style="background-color: white">                  layer = new Layer(master, this);</span><br>         273:  <span style="background-color: white">                  _rootLayer = layer;</span><br>         274:  <span style="background-color: white">              } else {</span><br>         275:  <span style="background-color: white">                  Layer parent = getLayer();</span><br>         276:  <span style="background-color: white">      </span><br>         277:  <span style="background-color: white">                  layer = new Layer(parent, master, this);</span><br>         278:  <span style="background-color: white">      </span><br>         279:  <span style="background-color: white">                  parent.addChild(layer);</span><br>         280:  <span style="background-color: white">              }</span><br>         281:  <span style="background-color: white">      </span><br>         282:  <span style="background-color: white">              pushLayer(layer);</span><br>         283:  <span style="background-color: white">          }</span><br>         284:  <span style="background-color: white">      </span><br>         285:  <span style="background-color: white">          public void pushLayer(Layer layer) {</span><br>         286:  <span style="background-color: white">              _layers.add(layer);</span><br>         287:  <span style="background-color: white">          }</span><br>         288:  <span style="background-color: white">      </span><br>         289:  <span style="background-color: white">          public void popLayer() {</span><br>         290:  <span style="background-color: white">              Layer layer = getLayer();</span><br>         291:  <span style="background-color: white">      </span><br>         292:  <span style="background-color: white">              layer.finish(this);</span><br>         293:  <span style="background-color: white">      </span><br>         294:  <span style="background-color: white">              _layers.removeLast();</span><br>         295:  <span style="background-color: white">          }</span><br>         296:  <span style="background-color: white">      </span><br>         297:  <span style="background-color: white">          public Layer getLayer() {</span><br>         298:  <span style="background-color: white">              return _layers.getLast();</span><br>         299:  <span style="background-color: white">          }</span><br>         300:  <span style="background-color: white">      </span><br>         301:  <span style="background-color: white">          public Layer getRootLayer() {</span><br>         302:  <span style="background-color: white">              return _rootLayer;</span><br>         303:  <span style="background-color: white">          }</span><br>         304:  <span style="background-color: white">      </span><br>         305:  <span style="background-color: white">          public void translate(int x, int y) {</span><br>         306:  <span style="background-color: white">              getBlockFormattingContext().translate(x, y);</span><br>         307:  <span style="background-color: white">          }</span><br>         308:  <span style="background-color: white">      </span><br>         309:  <span style="background-color: white">          /* code to keep track of all of the id'd boxes */</span><br>         310:  <span style="background-color: white">          public void addBoxId(String id, Box box) {</span><br>         311:  <span style="background-color: white">              _sharedContext.addBoxId(id, box);</span><br>         312:  <span style="background-color: white">          }</span><br>         313:  <span style="background-color: white">      </span><br>         314:  <span style="background-color: white">          public void removeBoxId(String id) {</span><br>         315:  <span style="background-color: white">              _sharedContext.removeBoxId(id);</span><br>         316:  <span style="background-color: white">          }</span><br>         317:  <span style="background-color: white">      </span><br>         318:  <span style="background-color: white">          public boolean isInteractive() {</span><br>         319:  <span style="background-color: white">              return _sharedContext.isInteractive();</span><br>         320:  <span style="background-color: white">          }</span><br>         321:  <span style="background-color: white">      </span><br>         322:  <span style="background-color: white">          public float getMmPerDot() {</span><br>         323:  <span style="background-color: white">              return _sharedContext.getMmPerDotParent();</span><br>         324:  <span style="background-color: white">          }</span><br>         325:  <span style="background-color: white">      </span><br>         326:  <span style="background-color: white">          public int getDotsPerPixel() {</span><br>         327:  <span style="background-color: white">              return _sharedContext.getDotsPerPixel();</span><br>         328:  <span style="background-color: white">          }</span><br>         329:  <span style="background-color: white">      </span><br>         330:  <span style="background-color: white">          public float getFontSize2D(FontSpecification font) {</span><br>         331:  <span style="background-color: white">              return _sharedContext.getFont(font).getSize2D();</span><br>         332:  <span style="background-color: white">          }</span><br>         333:  <span style="background-color: white">      </span><br>         334:  <span style="background-color: white">          public float getXHeight(FontSpecification parentFont) {</span><br>         335:  <span style="background-color: white">              return _sharedContext.getXHeight(getFontContext(), parentFont);</span><br>         336:  <span style="background-color: white">          }</span><br>         337:  <span style="background-color: white">      </span><br>         338:  <span style="background-color: white">          public FSFont getFont(FontSpecification font) {</span><br>         339:  <span style="background-color: white">              return _sharedContext.getFont(font);</span><br>         340:  <span style="background-color: white">          }</span><br>         341:  <span style="background-color: white">      </span><br>         342:  <span style="background-color: white">          public UserAgentCallback getUac() {</span><br>         343:  <span style="background-color: white">              return _sharedContext.getUserAgentCallback();</span><br>         344:  <span style="background-color: white">          }</span><br>         345:  <span style="background-color: white">      </span><br>         346:  <span style="background-color: white">          public boolean isPrint() {</span><br>         347:  <span style="background-color: white">          	if (this.isPrintOverride != null) {</span><br>         348:  <span style="background-color: white">          		return this.isPrintOverride;</span><br>         349:  <span style="background-color: white">          	}</span><br>         350:  <span style="background-color: white">          	</span><br>         351:  <span style="background-color: white">              return _sharedContext.isPrint();</span><br>         352:  <span style="background-color: white">          }</span><br>         353:  <span style="background-color: white">          </span><br>         354:  <span style="background-color: white">          /**</span><br>         355:  <span style="background-color: white">           * @param isPrint true, false or null for no override.</span><br>         356:  <span style="background-color: white">           */</span><br>         357:  <span style="background-color: white">          public void setIsPrintOverride(Boolean isPrint) {</span><br>         358:  <span style="background-color: white">          	this.isPrintOverride = isPrint;</span><br>         359:  <span style="background-color: white">          }</span><br>         360:  <span style="background-color: white">      </span><br>         361:  <span style="background-color: white">          public StyleTracker getFirstLinesTracker() {</span><br>         362:  <span style="background-color: white">              return _firstLines;</span><br>         363:  <span style="background-color: white">          }</span><br>         364:  <span style="background-color: white">      </span><br>         365:  <span style="background-color: white">          public StyleTracker getFirstLettersTracker() {</span><br>         366:  <span style="background-color: white">              return _firstLetters;</span><br>         367:  <span style="background-color: white">          }</span><br>         368:  <span style="background-color: white">      </span><br>         369:  <span style="background-color: white">          public MarkerData getCurrentMarkerData() {</span><br>         370:  <span style="background-color: white">              return _currentMarkerData;</span><br>         371:  <span style="background-color: white">          }</span><br>         372:  <span style="background-color: white">      </span><br>         373:  <span style="background-color: white">          public void setCurrentMarkerData(MarkerData currentMarkerData) {</span><br>         374:  <span style="background-color: white">              _currentMarkerData = currentMarkerData;</span><br>         375:  <span style="background-color: white">          }</span><br>         376:  <span style="background-color: white">      </span><br>         377:  <span style="background-color: white">          public ReplacedElementFactory getReplacedElementFactory() {</span><br>         378:  <span style="background-color: white">              return _sharedContext.getReplacedElementFactory();</span><br>         379:  <span style="background-color: white">          }</span><br>         380:  <span style="background-color: white">      </span><br>         381:  <span style="background-color: white">          @Override</span><br>         382:  <span style="background-color: white">          public FontContext getFontContext() {</span><br>         383:  <span style="background-color: white">              return _fontContext;</span><br>         384:  <span style="background-color: white">          }</span><br>         385:  <span style="background-color: white">      </span><br>         386:  <span style="background-color: white">          public void setFontContext(FontContext fontContext) {</span><br>         387:  <span style="background-color: white">              _fontContext = fontContext;</span><br>         388:  <span style="background-color: white">          }</span><br>         389:  <span style="background-color: white">      </span><br>         390:  <span style="background-color: white">          public ContentFunctionFactory getContentFunctionFactory() {</span><br>         391:  <span style="background-color: white">              return _contentFunctionFactory;</span><br>         392:  <span style="background-color: white">          }</span><br>         393:  <span style="background-color: white">      </span><br>         394:  <span style="background-color: white">          public SharedContext getSharedContext() {</span><br>         395:  <span style="background-color: white">              return _sharedContext;</span><br>         396:  <span style="background-color: white">          }</span><br>         397:  <span style="background-color: white">      </span><br>         398:  <span style="background-color: white">          public int getExtraSpaceBottom() {</span><br>         399:  <span style="background-color: white">              return _extraSpaceBottom;</span><br>         400:  <span style="background-color: white">          }</span><br>         401:  <span style="background-color: white">      </span><br>         402:  <span style="background-color: white">          public void setExtraSpaceBottom(int extraSpaceBottom) {</span><br>         403:  <span style="background-color: white">              _extraSpaceBottom = extraSpaceBottom;</span><br>         404:  <span style="background-color: white">          }</span><br>         405:  <span style="background-color: white">      </span><br>         406:  <span style="background-color: white">          public int getExtraSpaceTop() {</span><br>         407:  <span style="background-color: white">              return _extraSpaceTop;</span><br>         408:  <span style="background-color: white">          }</span><br>         409:  <span style="background-color: white">      </span><br>         410:  <span style="background-color: white">          public void setExtraSpaceTop(int extraSpaceTop) {</span><br>         411:  <span style="background-color: white">              _extraSpaceTop = extraSpaceTop;</span><br>         412:  <span style="background-color: white">          }</span><br>         413:  <span style="background-color: white">      </span><br>         414:  <span style="background-color: yellow">          public void resolveCounters(CalculatedStyle style, Integer startIndex) {</span><br>         415:  <span style="background-color: yellow">              //new context for child elements</span><br>         416:  <span style="background-color: yellow">              CounterContext cc = new CounterContext(style, startIndex);</span><br>         417:  <span style="background-color: yellow">              _counterContextMap.put(style, cc);</span><br>         418:  <span style="background-color: yellow">          }</span><br>         419:  <span style="background-color: white">      </span><br>         420:  <span style="background-color: white">          public void resolveCounters(CalculatedStyle style) {</span><br>         421:  <span style="background-color: white">          	resolveCounters(style, null);</span><br>         422:  <span style="background-color: white">          }</span><br>         423:  <span style="background-color: white">      </span><br>         424:  <span style="background-color: yellow">          public CounterContext getCounterContext(CalculatedStyle style) {</span><br>         425:  <span style="background-color: white">              return _counterContextMap.get(style);</span><br>         426:  <span style="background-color: white">          }</span><br>         427:  <span style="background-color: white">      </span><br>         428:  <span style="background-color: white">          public FSFontMetrics getFSFontMetrics(FSFont font) {</span><br>         429:  <span style="background-color: white">              return getTextRenderer().getFSFontMetrics(getFontContext(), font, "");</span><br>         430:  <span style="background-color: white">          }</span><br>         431:  <span style="background-color: white">      </span><br>         432:  <span style="background-color: yellow">          public class CounterContext {</span><br>         433:  <span style="background-color: yellow">              private Map
       <string, integer>
         _counters = new HashMap&lt;&gt;();
       </string,></span><br>         434:  <span style="background-color: yellow">              /**</span><br>         435:  <span style="background-color: yellow">               * This is different because it needs to work even when the counter- properties cascade</span><br>         436:  <span style="background-color: yellow">               * and it should also logically be redefined on each level (think list-items within list-items)</span><br>         437:  <span style="background-color: yellow">               */</span><br>         438:  <span style="background-color: yellow">              private CounterContext _parent;</span><br>         439:  <span style="background-color: yellow">      </span><br>         440:  <span style="background-color: yellow">              /**</span><br>         441:  <span style="background-color: yellow">               * A CounterContext should really be reflected in the element hierarchy, but CalculatedStyles</span><br>         442:  <span style="background-color: yellow">               * reflect the ancestor hierarchy just as well and also handles pseudo-elements seamlessly.</span><br>         443:  <span style="background-color: yellow">               *</span><br>         444:  <span style="background-color: yellow">               * @param style</span><br>         445:  <span style="background-color: yellow">               */</span><br>         446:  <span style="background-color: yellow">              CounterContext(CalculatedStyle style, Integer startIndex) {</span><br>         447:  <span style="background-color: yellow">              	// Numbering restarted via 
       <ol start="x"></ol></span><br>         448:  <span style="background-color: yellow">      			if (startIndex != null) {</span><br>         449:  <span style="background-color: yellow">      				_counters.put("list-item", startIndex);</span><br>         450:  <span style="background-color: yellow">      			}</span><br>         451:  <span style="background-color: yellow">                  _parent = _counterContextMap.get(style.getParent());</span><br>         452:  <span style="background-color: yellow">                  if (_parent == null) _parent = new CounterContext();//top-level context, above root element</span><br>         453:  <span style="background-color: yellow">                  //first the explicitly named counters</span><br>         454:  <span style="background-color: yellow">                  List
       <counterdata>
         resets = style.getCounterReset();
       </counterdata></span><br>         455:  <span style="background-color: yellow">                  if (resets != null) {</span><br>         456:  <span style="background-color: yellow">                      resets.forEach(_parent::resetCounter);</span><br>         457:  <span style="background-color: yellow">                  }</span><br>         458:  <span style="background-color: yellow">      </span><br>         459:  <span style="background-color: yellow">                  List
       <counterdata>
         increments = style.getCounterIncrement();
       </counterdata></span><br>         460:  <span style="background-color: yellow">                  if (increments != null) {</span><br>         461:  <span style="background-color: yellow">                      for (CounterData cd : increments) {</span><br>         462:  <span style="background-color: yellow">                          if (!_parent.incrementCounter(cd)) {</span><br>         463:  <span style="background-color: yellow">                              _parent.resetCounter(new CounterData(cd.getName(), 0));</span><br>         464:  <span style="background-color: yellow">                              _parent.incrementCounter(cd);</span><br>         465:  <span style="background-color: yellow">                          }</span><br>         466:  <span style="background-color: yellow">                      }</span><br>         467:  <span style="background-color: yellow">                  }</span><br>         468:  <span style="background-color: yellow">      </span><br>         469:  <span style="background-color: yellow">                  // then the implicit list-item counter</span><br>         470:  <span style="background-color: yellow">      			if (style.isIdent(CSSName.DISPLAY, IdentValue.LIST_ITEM)) {</span><br>         471:  <span style="background-color: yellow">      				// Numbering restarted via <li value="x"></li></span><br>         472:  <span style="background-color: yellow">      				if (startIndex != null) {</span><br>         473:  <span style="background-color: yellow">      					_parent._counters.put("list-item", startIndex);</span><br>         474:  <span style="background-color: yellow">      				}</span><br>         475:  <span style="background-color: yellow">      				_parent.incrementListItemCounter(1);</span><br>         476:  <span style="background-color: yellow">      			}</span><br>         477:  <span style="background-color: yellow">              }</span><br>         478:  <span style="background-color: yellow">      </span><br>         479:  <span style="background-color: yellow">              private CounterContext() {</span><br>         480:  <span style="background-color: yellow">      </span><br>         481:  <span style="background-color: yellow">              }</span><br>         482:  <span style="background-color: yellow">      </span><br>         483:  <span style="background-color: yellow">              /**</span><br>         484:  <span style="background-color: yellow">               * @param cd</span><br>         485:  <span style="background-color: yellow">               * @return true if a counter was found and incremented</span><br>         486:  <span style="background-color: yellow">               */</span><br>         487:  <span style="background-color: yellow">              private boolean incrementCounter(CounterData cd) {</span><br>         488:  <span style="background-color: yellow">                  // list-item is a reserved name for list-item counter in CSS3</span><br>         489:  <span style="background-color: yellow">                  if ("list-item".equals(cd.getName())) {</span><br>         490:  <span style="background-color: yellow">                      incrementListItemCounter(cd.getValue());</span><br>         491:  <span style="background-color: yellow">                      return true;</span><br>         492:  <span style="background-color: yellow">                  } else {</span><br>         493:  <span style="background-color: yellow">                      Integer currentValue = _counters.get(cd.getName());</span><br>         494:  <span style="background-color: yellow">                      if (currentValue == null) {</span><br>         495:  <span style="background-color: yellow">                          if (_parent == null) {</span><br>         496:  <span style="background-color: yellow">                              return false;</span><br>         497:  <span style="background-color: yellow">                          }</span><br>         498:  <span style="background-color: yellow">                          return _parent.incrementCounter(cd);</span><br>         499:  <span style="background-color: yellow">                      } else {</span><br>         500:  <span style="background-color: yellow">                          _counters.put(cd.getName(), currentValue + cd.getValue());</span><br>         501:  <span style="background-color: yellow">                          return true;</span><br>         502:  <span style="background-color: yellow">                      }</span><br>         503:  <span style="background-color: yellow">                  }</span><br>         504:  <span style="background-color: yellow">              }</span><br>         505:  <span style="background-color: yellow">      </span><br>         506:  <span style="background-color: yellow">              private void incrementListItemCounter(int increment) {</span><br>         507:  <span style="background-color: yellow">                  Integer currentValue = _counters.get("list-item");</span><br>         508:  <span style="background-color: yellow">                  if (currentValue == null) {</span><br>         509:  <span style="background-color: yellow">                      currentValue = 0;</span><br>         510:  <span style="background-color: yellow">                  }</span><br>         511:  <span style="background-color: yellow">                  _counters.put("list-item", currentValue + increment);</span><br>         512:  <span style="background-color: yellow">              }</span><br>         513:  <span style="background-color: yellow">      </span><br>         514:  <span style="background-color: yellow">              private void resetCounter(CounterData cd) {</span><br>         515:  <span style="background-color: yellow">                  _counters.put(cd.getName(), cd.getValue());</span><br>         516:  <span style="background-color: yellow">              }</span><br>         517:  <span style="background-color: yellow">      </span><br>         518:  <span style="background-color: yellow">              public int getCurrentCounterValue(String name) {</span><br>         519:  <span style="background-color: yellow">                  //only the counters of the parent are in scope</span><br>         520:  <span style="background-color: yellow">                  //_parent is never null for a publicly accessible CounterContext</span><br>         521:  <span style="background-color: yellow">                  Integer value = _parent.getCounter(name);</span><br>         522:  <span style="background-color: yellow">                  if (value == null) {</span><br>         523:  <span style="background-color: yellow">                      _parent.resetCounter(new CounterData(name, 0));</span><br>         524:  <span style="background-color: yellow">                      return 0;</span><br>         525:  <span style="background-color: yellow">                  } else {</span><br>         526:  <span style="background-color: yellow">                      return value.intValue();</span><br>         527:  <span style="background-color: yellow">                  }</span><br>         528:  <span style="background-color: yellow">              }</span><br>         529:  <span style="background-color: yellow">      </span><br>         530:  <span style="background-color: yellow">              private Integer getCounter(String name) {</span><br>         531:  <span style="background-color: yellow">                  Integer value = _counters.get(name);</span><br>         532:  <span style="background-color: yellow">                  if (value != null) return value;</span><br>         533:  <span style="background-color: yellow">                  if (_parent == null) return null;</span><br>         534:  <span style="background-color: yellow">                  return _parent.getCounter(name);</span><br>         535:  <span style="background-color: yellow">              }</span><br>         536:  <span style="background-color: yellow">      </span><br>         537:  <span style="background-color: yellow">              public List
       <integer>
         getCurrentCounterValues(String name) {
       </integer></span><br>         538:  <span style="background-color: yellow">                  //only the counters of the parent are in scope</span><br>         539:  <span style="background-color: yellow">                  //_parent is never null for a publicly accessible CounterContext</span><br>         540:  <span style="background-color: yellow">                  List
       <integer>
         values = new ArrayList&lt;&gt;();
       </integer></span><br>         541:  <span style="background-color: yellow">                  _parent.getCounterValues(name, values);</span><br>         542:  <span style="background-color: yellow">                  if (values.size() == 0) {</span><br>         543:  <span style="background-color: yellow">                      _parent.resetCounter(new CounterData(name, 0));</span><br>         544:  <span style="background-color: yellow">                      values.add(Integer.valueOf(0));</span><br>         545:  <span style="background-color: yellow">                  }</span><br>         546:  <span style="background-color: yellow">                  return values;</span><br>         547:  <span style="background-color: yellow">              }</span><br>         548:  <span style="background-color: yellow">      </span><br>         549:  <span style="background-color: yellow">              private void getCounterValues(String name, List
       <integer>
         values) {
       </integer></span><br>         550:  <span style="background-color: yellow">                  if (_parent != null) _parent.getCounterValues(name, values);</span><br>         551:  <span style="background-color: yellow">                  Integer value = _counters.get(name);</span><br>         552:  <span style="background-color: yellow">                  if (value != null) values.add(value);</span><br>         553:  <span style="background-color: yellow">              }</span><br>         554:  <span style="background-color: yellow">          }</span><br>         555:  <span style="background-color: white">      </span><br>         556:  <span style="background-color: white">          public String getPageName() {</span><br>         557:  <span style="background-color: white">              return _pageName;</span><br>         558:  <span style="background-color: white">          }</span><br>         559:  <span style="background-color: white">      </span><br>         560:  <span style="background-color: white">          public void setPageName(String currentPageName) {</span><br>         561:  <span style="background-color: white">              _pageName = currentPageName;</span><br>         562:  <span style="background-color: white">          }</span><br>         563:  <span style="background-color: white">      </span><br>         564:  <span style="background-color: white">          public int getNoPageBreak() {</span><br>         565:  <span style="background-color: white">              return _noPageBreak;</span><br>         566:  <span style="background-color: white">          }</span><br>         567:  <span style="background-color: white">      </span><br>         568:  <span style="background-color: white">          public void setNoPageBreak(int noPageBreak) {</span><br>         569:  <span style="background-color: white">              _noPageBreak = noPageBreak;</span><br>         570:  <span style="background-color: white">          }</span><br>         571:  <span style="background-color: white">      </span><br>         572:  <span style="background-color: white">          public boolean isPageBreaksAllowed() {</span><br>         573:  <span style="background-color: white">              return _noPageBreak == 0;</span><br>         574:  <span style="background-color: white">          }</span><br>         575:  <span style="background-color: white">      </span><br>         576:  <span style="background-color: white">          public String getPendingPageName() {</span><br>         577:  <span style="background-color: white">              return _pendingPageName;</span><br>         578:  <span style="background-color: white">          }</span><br>         579:  <span style="background-color: white">      </span><br>         580:  <span style="background-color: white">          public void setPendingPageName(String pendingPageName) {</span><br>         581:  <span style="background-color: white">              _pendingPageName = pendingPageName;</span><br>         582:  <span style="background-color: white">          }</span><br>         583:  <span style="background-color: white">      </span><br>         584:  <span style="background-color: white">          public Layer getRootDocumentLayer() {</span><br>         585:  <span style="background-color: white">              return _rootDocumentLayer;</span><br>         586:  <span style="background-color: white">          }</span><br>         587:  <span style="background-color: white">      </span><br>         588:  <span style="background-color: white">          public void setRootDocumentLayer(Layer rootDocumentLayer) {</span><br>         589:  <span style="background-color: white">              _rootDocumentLayer = rootDocumentLayer;</span><br>         590:  <span style="background-color: white">          }</span><br>         591:  <span style="background-color: white">      </span><br>         592:  <span style="background-color: white">          public PageBox getPage() {</span><br>         593:  <span style="background-color: white">              return _page;</span><br>         594:  <span style="background-color: white">          }</span><br>         595:  <span style="background-color: white">      </span><br>         596:  <span style="background-color: white">          public void setPage(PageBox page) {</span><br>         597:  <span style="background-color: white">              _page = page;</span><br>         598:  <span style="background-color: white">          }</span><br>         599:  <span style="background-color: white">      </span><br>         600:  <span style="background-color: white">          public boolean isMayCheckKeepTogether() {</span><br>         601:  <span style="background-color: white">              return _mayCheckKeepTogether;</span><br>         602:  <span style="background-color: white">          }</span><br>         603:  <span style="background-color: white">      </span><br>         604:  <span style="background-color: white">          public void setMayCheckKeepTogether(boolean mayKeepTogether) {</span><br>         605:  <span style="background-color: white">              _mayCheckKeepTogether = mayKeepTogether;</span><br>         606:  <span style="background-color: white">          }</span><br>         607:  <span style="background-color: white">      </span><br>         608:  <span style="background-color: white">          public boolean isLineBreakedBecauseOfNoWrap() {</span><br>         609:  <span style="background-color: white">              return _lineBreakedBecauseOfNoWrap;</span><br>         610:  <span style="background-color: white">          }</span><br>         611:  <span style="background-color: white">      </span><br>         612:  <span style="background-color: white">          public void setLineBreakedBecauseOfNoWrap(boolean value) {</span><br>         613:  <span style="background-color: white">              _lineBreakedBecauseOfNoWrap = value;</span><br>         614:  <span style="background-color: white">          }</span><br>         615:  <span style="background-color: white">      </span><br>         616:  <span style="background-color: white">          public BreakAtLineContext getBreakAtLineContext() {</span><br>         617:  <span style="background-color: white">              return _breakAtLineContext;</span><br>         618:  <span style="background-color: white">          }</span><br>         619:  <span style="background-color: white">      </span><br>         620:  <span style="background-color: white">          public void setBreakAtLineContext(BreakAtLineContext breakAtLineContext) {</span><br>         621:  <span style="background-color: white">              _breakAtLineContext = breakAtLineContext;</span><br>         622:  <span style="background-color: white">          }</span><br>         623:  <span style="background-color: white">      }</span><br></pre> </code> 
   </div> 
   <div class="column"> 
    <h2>Patched Code:</h2> <code> <pre id="patched-trace">        1-&gt;N:  <span style="background-color: white">      /*</span><br>        2-&gt;N:  <span style="background-color: white">       * {{{ header &amp; license</span><br>        3-&gt;N:  <span style="background-color: white">       * Copyright (c) 2004, 2005 Joshua Marinacci, Torbjoern Gannholm</span><br>        4-&gt;N:  <span style="background-color: white">       *</span><br>        5-&gt;N:  <span style="background-color: white">       * This program is free software; you can redistribute it and/or</span><br>        6-&gt;N:  <span style="background-color: white">       * modify it under the terms of the GNU Lesser General Public License</span><br>        7-&gt;N:  <span style="background-color: white">       * as published by the Free Software Foundation; either version 2.1</span><br>        8-&gt;N:  <span style="background-color: white">       * of the License, or (at your option) any later version.</span><br>        9-&gt;N:  <span style="background-color: white">       *</span><br>       10-&gt;N:  <span style="background-color: white">       * This program is distributed in the hope that it will be useful,</span><br>       11-&gt;N:  <span style="background-color: white">       * but WITHOUT ANY WARRANTY; without even the implied warranty of</span><br>       12-&gt;N:  <span style="background-color: white">       * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.	See the</span><br>       13-&gt;N:  <span style="background-color: white">       * GNU Lesser General Public License for more details.</span><br>       14-&gt;N:  <span style="background-color: white">       *</span><br>       15-&gt;N:  <span style="background-color: white">       * You should have received a copy of the GNU Lesser General Public License</span><br>       16-&gt;N:  <span style="background-color: white">       * along with this program; if not, write to the Free Software</span><br>       17-&gt;N:  <span style="background-color: white">       * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.</span><br>       18-&gt;N:  <span style="background-color: white">       * }}}</span><br>       19-&gt;N:  <span style="background-color: white">       */</span><br>       20-&gt;N:  <span style="background-color: white">      package com.openhtmltopdf.layout;</span><br>       21-&gt;N:  <span style="background-color: white">      </span><br>       22-&gt;N:  <span style="background-color: white">      import java.awt.Rectangle;</span><br>       23-&gt;N:  <span style="background-color: white">      import java.util.HashMap;</span><br>       24-&gt;N:  <span style="background-color: white">      import java.util.LinkedList;</span><br>       25-&gt;N:  <span style="background-color: white">      import java.util.Map;</span><br>       26-&gt;N:  <span style="background-color: white">      </span><br>       27-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.bidi.BidiReorderer;</span><br>       28-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.bidi.BidiSplitter;</span><br>       29-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.bidi.BidiSplitterFactory;</span><br>       30-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.bidi.ParagraphSplitter;</span><br>       31-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.bidi.SimpleBidiReorderer;</span><br>       32-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.bidi.SimpleBidiSplitterFactory;</span><br>       33-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.context.ContentFunctionFactory;</span><br>       34-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.context.StyleReference;</span><br>       35-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.css.style.CalculatedStyle;</span><br>       36-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.css.style.CssContext;</span><br>       37-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.css.value.FontSpecification;</span><br>       38-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.extend.FSCanvas;</span><br>       39-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.extend.FontContext;</span><br>       40-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.extend.NamespaceHandler;</span><br>       41-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.extend.ReplacedElementFactory;</span><br>       42-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.extend.TextRenderer;</span><br>       43-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.extend.UserAgentCallback;</span><br>       44-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.layout.counter.AbstractCounterContext;</span><br>       45-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.layout.counter.CounterContext;</span><br>       46-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.render.Box;</span><br>       47-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.render.FSFont;</span><br>       48-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.render.FSFontMetrics;</span><br>       49-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.render.MarkerData;</span><br>       50-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.render.PageBox;</span><br>       51-&gt;N:  <span style="background-color: white">      </span><br>       52-&gt;N:  <span style="background-color: white">      /**</span><br>       53-&gt;N:  <span style="background-color: white">       * This class tracks state which changes over the course of a layout run.</span><br>       54-&gt;N:  <span style="background-color: white">       * Generally speaking, if possible, state information should be stored in the box</span><br>       55-&gt;N:  <span style="background-color: white">       * tree and not here.  It also provides pass-though calls to many methods in</span><br>       56-&gt;N:  <span style="background-color: white">       * {@link SharedContext}.</span><br>       57-&gt;N:  <span style="background-color: white">       */</span><br>       58-&gt;N:  <span style="background-color: white">      public class LayoutContext implements CssContext {</span><br>       59-&gt;U:  <span style="background-color: yellow">          public enum BlockBoxingState {</span><br>       60-&gt;U:  <span style="background-color: yellow">              NOT_SET,</span><br>       61-&gt;U:  <span style="background-color: yellow">              ALLOW,</span><br>       62-&gt;U:  <span style="background-color: yellow">              DENY;</span><br>       63-&gt;U:  <span style="background-color: yellow">          }</span><br>       64-&gt;N:  <span style="background-color: white">      </span><br>       65-&gt;U:  <span style="background-color: yellow">          private BlockBoxingState _blockBoxingState = BlockBoxingState.NOT_SET;</span><br>       66-&gt;N:  <span style="background-color: white">      </span><br>      67-&gt;62:  <span style="background-color: white">          private SharedContext _sharedContext;</span><br>       68-&gt;N:  <span style="background-color: white">      </span><br>      69-&gt;64:  <span style="background-color: white">          private Layer _rootLayer;</span><br>       70-&gt;N:  <span style="background-color: white">      </span><br>      71-&gt;66:  <span style="background-color: white">          private StyleTracker _firstLines;</span><br>      72-&gt;67:  <span style="background-color: white">          private StyleTracker _firstLetters;</span><br>      73-&gt;68:  <span style="background-color: white">          private MarkerData _currentMarkerData;</span><br>       74-&gt;N:  <span style="background-color: white">      </span><br>      75-&gt;70:  <span style="background-color: white">          private LinkedList
       <blockformattingcontext>
         _bfcs;
       </blockformattingcontext></span><br>      76-&gt;71:  <span style="background-color: white">          private LinkedList
       <layer>
         _layers;
       </layer></span><br>       77-&gt;N:  <span style="background-color: white">      </span><br>      78-&gt;73:  <span style="background-color: white">          private FontContext _fontContext;</span><br>       79-&gt;N:  <span style="background-color: white">      </span><br>      80-&gt;75:  <span style="background-color: white">          private final ContentFunctionFactory _contentFunctionFactory = new ContentFunctionFactory();</span><br>       81-&gt;N:  <span style="background-color: white">      </span><br>      82-&gt;77:  <span style="background-color: white">          private int _extraSpaceTop;</span><br>      83-&gt;78:  <span style="background-color: white">          private int _extraSpaceBottom;</span><br>       84-&gt;N:  <span style="background-color: white">      </span><br>       85-&gt;U:  <span style="background-color: yellow">          public final Map
       <calculatedstyle, countercontext>
         _counterContextMap = new HashMap&lt;&gt;();
       </calculatedstyle,></span><br>       86-&gt;N:  <span style="background-color: white">      </span><br>      87-&gt;82:  <span style="background-color: white">          private String _pendingPageName;</span><br>      88-&gt;83:  <span style="background-color: white">          private String _pageName;</span><br>       89-&gt;N:  <span style="background-color: white">      </span><br>      90-&gt;85:  <span style="background-color: white">          private int _noPageBreak = 0;</span><br>       91-&gt;N:  <span style="background-color: white">      </span><br>      92-&gt;87:  <span style="background-color: white">          private Layer _rootDocumentLayer;</span><br>      93-&gt;88:  <span style="background-color: white">          private PageBox _page;</span><br>       94-&gt;N:  <span style="background-color: white">      </span><br>      95-&gt;90:  <span style="background-color: white">          private boolean _mayCheckKeepTogether = true;</span><br>       96-&gt;N:  <span style="background-color: white">      </span><br>      97-&gt;92:  <span style="background-color: white">          private boolean _lineBreakedBecauseOfNoWrap = false;</span><br>       98-&gt;N:  <span style="background-color: white">      </span><br>      99-&gt;94:  <span style="background-color: white">          private BreakAtLineContext _breakAtLineContext;</span><br>      100-&gt;N:  <span style="background-color: white">      </span><br>     101-&gt;96:  <span style="background-color: white">          private Boolean isPrintOverride = null; // True, false, or null for no override.</span><br>      102-&gt;N:  <span style="background-color: white">      </span><br>      103-&gt;U:  <span style="background-color: yellow">          private boolean _isInFloatBottom;</span><br>      104-&gt;N:  <span style="background-color: white">      </span><br>      105-&gt;U:  <span style="background-color: yellow">          private LayoutState _savedLayoutState;</span><br>      106-&gt;N:  <span style="background-color: white">      </span><br>      107-&gt;U:  <span style="background-color: yellow">          private int _footnoteIndex;</span><br>      108-&gt;U:  <span style="background-color: yellow">          private FootnoteManager _footnoteManager;</span><br>      109-&gt;U:  <span style="background-color: yellow">          private boolean _isFootnoteAllowed = true;</span><br>      110-&gt;N:  <span style="background-color: white">      </span><br>     111-&gt;98:  <span style="background-color: cyan">          @Override</span><br>     112-&gt;99:  <span style="background-color: white">          public TextRenderer getTextRenderer() {</span><br>      113-&gt;N:  <span style="background-color: white">              return _sharedContext.getTextRenderer();</span><br>      114-&gt;N:  <span style="background-color: white">          }</span><br>      115-&gt;N:  <span style="background-color: white">      </span><br>    116-&gt;103:  <span style="background-color: cyan">          public StyleReference getCss() {</span><br>      117-&gt;N:  <span style="background-color: white">              return _sharedContext.getCss();</span><br>      118-&gt;N:  <span style="background-color: white">          }</span><br>      119-&gt;N:  <span style="background-color: white">      </span><br>    120-&gt;107:  <span style="background-color: white">          public FSCanvas getCanvas() {</span><br>      121-&gt;N:  <span style="background-color: white">              return _sharedContext.getCanvas();</span><br>      122-&gt;N:  <span style="background-color: white">          }</span><br>      123-&gt;N:  <span style="background-color: white">      </span><br>    124-&gt;111:  <span style="background-color: white">          public Rectangle getFixedRectangle() {</span><br>      125-&gt;N:  <span style="background-color: white">              return _sharedContext.getFixedRectangle();</span><br>      126-&gt;N:  <span style="background-color: white">          }</span><br>      127-&gt;N:  <span style="background-color: white">      </span><br>    128-&gt;115:  <span style="background-color: cyan">          public NamespaceHandler getNamespaceHandler() {</span><br>      129-&gt;N:  <span style="background-color: white">              return _sharedContext.getNamespaceHandler();</span><br>      130-&gt;N:  <span style="background-color: white">          }</span><br>      131-&gt;N:  <span style="background-color: white">          </span><br>    132-&gt;119:  <span style="background-color: white">          private final ParagraphSplitter _splitter = new ParagraphSplitter();</span><br>    133-&gt;120:  <span style="background-color: white">          private BidiSplitterFactory _bidiSplitterFactory = new SimpleBidiSplitterFactory();</span><br>    134-&gt;121:  <span style="background-color: white">          private byte _defaultTextDirection = BidiSplitter.LTR;</span><br>      135-&gt;N:  <span style="background-color: white">          </span><br>      136-&gt;N:  <span style="background-color: white">          /**</span><br>      137-&gt;N:  <span style="background-color: white">           * The paragraph splitter splits the document into paragraphs for the purpose of bi-directional</span><br>      138-&gt;N:  <span style="background-color: white">           * text analysis.</span><br>      139-&gt;N:  <span style="background-color: white">           */</span><br>    140-&gt;127:  <span style="background-color: cyan">          public ParagraphSplitter getParagraphSplitter() {</span><br>      141-&gt;N:  <span style="background-color: white">          	return _splitter;</span><br>      142-&gt;N:  <span style="background-color: white">          }</span><br>      143-&gt;N:  <span style="background-color: white">          </span><br>    144-&gt;131:  <span style="background-color: white">          private BidiReorderer _bidiReorderer = new SimpleBidiReorderer();</span><br>      145-&gt;N:  <span style="background-color: white">      </span><br>    146-&gt;133:  <span style="background-color: white">          public void setBidiReorderer(BidiReorderer reorderer) {</span><br>    147-&gt;134:  <span style="background-color: white">          	_bidiReorderer = reorderer;</span><br>      148-&gt;N:  <span style="background-color: white">          }</span><br>      149-&gt;N:  <span style="background-color: white">          </span><br>    150-&gt;137:  <span style="background-color: cyan">          public BidiReorderer getBidiReorderer() {</span><br>      151-&gt;N:  <span style="background-color: white">          	return _bidiReorderer;</span><br>      152-&gt;N:  <span style="background-color: white">          }</span><br>      153-&gt;N:  <span style="background-color: white">          </span><br>      154-&gt;N:  <span style="background-color: white">          /**</span><br>      155-&gt;N:  <span style="background-color: white">           * The bidi splitter is used to split text runs into LTR and RTL visual ordering.</span><br>      156-&gt;N:  <span style="background-color: white">           */</span><br>    157-&gt;144:  <span style="background-color: cyan">          public BidiSplitterFactory getBidiSplitterFactory() {</span><br>      158-&gt;N:  <span style="background-color: white">          	return this._bidiSplitterFactory;</span><br>      159-&gt;N:  <span style="background-color: white">          }</span><br>      160-&gt;N:  <span style="background-color: white">          </span><br>      161-&gt;N:  <span style="background-color: white">          /**</span><br>      162-&gt;N:  <span style="background-color: white">           * The bidi splitter is used to split text runs into LTR and RTL visual ordering.</span><br>      163-&gt;N:  <span style="background-color: white">           */</span><br>    164-&gt;151:  <span style="background-color: white">          public void setBidiSplitterFactory(BidiSplitterFactory factory) {</span><br>    165-&gt;152:  <span style="background-color: white">          	this._bidiSplitterFactory = factory;</span><br>      166-&gt;N:  <span style="background-color: white">          }</span><br>      167-&gt;N:  <span style="background-color: white">          </span><br>      168-&gt;N:  <span style="background-color: white">          /**</span><br>      169-&gt;N:  <span style="background-color: white">           * @return the default text direction for a document.</span><br>      170-&gt;N:  <span style="background-color: white">           */</span><br>    171-&gt;158:  <span style="background-color: white">          public byte getDefaultTextDirection() {</span><br>      172-&gt;N:  <span style="background-color: white">          	return _defaultTextDirection;</span><br>      173-&gt;N:  <span style="background-color: white">          }</span><br>      174-&gt;N:  <span style="background-color: white">          </span><br>      175-&gt;N:  <span style="background-color: white">          /**</span><br>      176-&gt;N:  <span style="background-color: white">           * @param direction either BidiSplitter.LTR or BidiSplitter.RTL.</span><br>      177-&gt;N:  <span style="background-color: white">           */</span><br>    178-&gt;165:  <span style="background-color: cyan">          public void setDefaultTextDirection(byte direction) {</span><br>    179-&gt;166:  <span style="background-color: cyan">          	this._defaultTextDirection = direction;</span><br>      180-&gt;N:  <span style="background-color: white">          }</span><br>      181-&gt;N:  <span style="background-color: white">          </span><br>      182-&gt;N:  <span style="background-color: white">          //the stuff that needs to have a separate instance for each run.</span><br>      183-&gt;U:  <span style="background-color: yellow">          LayoutContext(SharedContext sharedContext) {</span><br>      184-&gt;U:  <span style="background-color: yellow">              _sharedContext = sharedContext;</span><br>      185-&gt;U:  <span style="background-color: yellow">              </span><br>      186-&gt;U:  <span style="background-color: yellow">              _bfcs = new LinkedList&lt;&gt;();</span><br>      187-&gt;U:  <span style="background-color: yellow">              _layers = new LinkedList&lt;&gt;();</span><br>      188-&gt;U:  <span style="background-color: yellow">      </span><br>      189-&gt;U:  <span style="background-color: yellow">              _firstLines = StyleTracker.withNoStyles();</span><br>      190-&gt;U:  <span style="background-color: yellow">              _firstLetters = StyleTracker.withNoStyles();</span><br>      191-&gt;U:  <span style="background-color: yellow">          }</span><br>      192-&gt;N:  <span style="background-color: white">      </span><br>    193-&gt;180:  <span style="background-color: cyan">          public void reInit(boolean keepLayers) {</span><br>      194-&gt;U:  <span style="background-color: yellow">              _firstLines = StyleTracker.withNoStyles();</span><br>      195-&gt;U:  <span style="background-color: yellow">              _firstLetters = StyleTracker.withNoStyles();</span><br>    196-&gt;183:  <span style="background-color: cyan">              _currentMarkerData = null;</span><br>      197-&gt;N:  <span style="background-color: white">      </span><br>    198-&gt;185:  <span style="background-color: cyan">              _bfcs = new LinkedList&lt;&gt;();</span><br>      199-&gt;N:  <span style="background-color: white">      </span><br>    200-&gt;187:  <span style="background-color: cyan">              if (! keepLayers) {</span><br>    201-&gt;188:  <span style="background-color: cyan">                  _rootLayer = null;</span><br>    202-&gt;189:  <span style="background-color: cyan">                  _layers = new LinkedList&lt;&gt;();</span><br>      203-&gt;N:  <span style="background-color: white">              }</span><br>      204-&gt;N:  <span style="background-color: white">      </span><br>    205-&gt;192:  <span style="background-color: cyan">              _extraSpaceTop = 0;</span><br>    206-&gt;193:  <span style="background-color: cyan">              _extraSpaceBottom = 0;</span><br>      207-&gt;N:  <span style="background-color: white">          }</span><br>      208-&gt;N:  <span style="background-color: white">      </span><br>      209-&gt;U:  <span style="background-color: yellow">          public LayoutState captureLayoutState() {</span><br>      210-&gt;U:  <span style="background-color: yellow">              if (!isPrint()) {</span><br>      211-&gt;U:  <span style="background-color: yellow">                  return new LayoutState(</span><br>      212-&gt;U:  <span style="background-color: yellow">                      _bfcs,</span><br>      213-&gt;U:  <span style="background-color: yellow">                      _currentMarkerData,</span><br>      214-&gt;U:  <span style="background-color: yellow">                      _firstLetters,</span><br>      215-&gt;U:  <span style="background-color: yellow">                      _firstLines);</span><br>      216-&gt;U:  <span style="background-color: yellow">              } else {</span><br>      217-&gt;U:  <span style="background-color: yellow">                  return new LayoutState(</span><br>      218-&gt;U:  <span style="background-color: yellow">                          _bfcs,</span><br>      219-&gt;U:  <span style="background-color: yellow">                          _currentMarkerData,</span><br>      220-&gt;U:  <span style="background-color: yellow">                          _firstLetters,</span><br>      221-&gt;U:  <span style="background-color: yellow">                          _firstLines,</span><br>      222-&gt;U:  <span style="background-color: yellow">                          getPageName(),</span><br>      223-&gt;U:  <span style="background-color: yellow">                          getExtraSpaceTop(),</span><br>      224-&gt;U:  <span style="background-color: yellow">                          getExtraSpaceBottom(),</span><br>      225-&gt;U:  <span style="background-color: yellow">                          getNoPageBreak());</span><br>      226-&gt;U:  <span style="background-color: yellow">              }</span><br>      227-&gt;U:  <span style="background-color: yellow">          }</span><br>      228-&gt;N:  <span style="background-color: white">      </span><br>    229-&gt;215:  <span style="background-color: cyan">          public void restoreLayoutState(LayoutState layoutState) {</span><br>    230-&gt;216:  <span style="background-color: cyan">              _firstLines = layoutState.getFirstLines();</span><br>    231-&gt;217:  <span style="background-color: cyan">              _firstLetters = layoutState.getFirstLetters();</span><br>      232-&gt;N:  <span style="background-color: white">      </span><br>    233-&gt;219:  <span style="background-color: cyan">              _currentMarkerData = layoutState.getCurrentMarkerData();</span><br>      234-&gt;N:  <span style="background-color: white">      </span><br>    235-&gt;221:  <span style="background-color: cyan">              _bfcs = layoutState.getBFCs();</span><br>      236-&gt;N:  <span style="background-color: white">      </span><br>      237-&gt;N:  <span style="background-color: white">              if (isPrint()) {</span><br>    238-&gt;224:  <span style="background-color: cyan">                  setPageName(layoutState.getPageName());</span><br>    239-&gt;225:  <span style="background-color: cyan">                  setExtraSpaceBottom(layoutState.getExtraSpaceBottom());</span><br>    240-&gt;226:  <span style="background-color: cyan">                  setExtraSpaceTop(layoutState.getExtraSpaceTop());</span><br>    241-&gt;227:  <span style="background-color: cyan">                  setNoPageBreak(layoutState.getNoPageBreak());</span><br>      242-&gt;N:  <span style="background-color: white">              }</span><br>      243-&gt;N:  <span style="background-color: white">          }</span><br>      244-&gt;N:  <span style="background-color: white">      </span><br>      245-&gt;U:  <span style="background-color: yellow">          public LayoutState copyStateForRelayout() {</span><br>      246-&gt;U:  <span style="background-color: yellow">              if (_savedLayoutState != null &amp;&amp;</span><br>      247-&gt;U:  <span style="background-color: yellow">                  _savedLayoutState.equal(</span><br>      248-&gt;U:  <span style="background-color: yellow">                          _currentMarkerData,</span><br>      249-&gt;U:  <span style="background-color: yellow">                          _firstLetters,</span><br>      250-&gt;U:  <span style="background-color: yellow">                          _firstLines,</span><br>      251-&gt;U:  <span style="background-color: yellow">                          isPrint() ? getPageName() : null)) {</span><br>      252-&gt;U:  <span style="background-color: yellow">      </span><br>      253-&gt;U:  <span style="background-color: yellow">                  return _savedLayoutState;</span><br>      254-&gt;U:  <span style="background-color: yellow">              }</span><br>      255-&gt;U:  <span style="background-color: yellow">      </span><br>      256-&gt;U:  <span style="background-color: yellow">              _savedLayoutState =</span><br>      257-&gt;U:  <span style="background-color: yellow">                  new LayoutState(</span><br>      258-&gt;U:  <span style="background-color: yellow">                      _firstLetters,</span><br>      259-&gt;U:  <span style="background-color: yellow">                      _firstLines,</span><br>      260-&gt;U:  <span style="background-color: yellow">                      _currentMarkerData,</span><br>      261-&gt;U:  <span style="background-color: yellow">                      isPrint() ? getPageName() : null);</span><br>      262-&gt;U:  <span style="background-color: yellow">      </span><br>      263-&gt;U:  <span style="background-color: yellow">              return _savedLayoutState;</span><br>      264-&gt;U:  <span style="background-color: yellow">          }</span><br>      265-&gt;N:  <span style="background-color: white">      </span><br>    266-&gt;245:  <span style="background-color: cyan">          public void restoreStateForRelayout(LayoutState layoutState) {</span><br>    267-&gt;246:  <span style="background-color: cyan">              _firstLines = layoutState.getFirstLines();</span><br>    268-&gt;247:  <span style="background-color: cyan">              _firstLetters = layoutState.getFirstLetters();</span><br>      269-&gt;N:  <span style="background-color: white">      </span><br>    270-&gt;249:  <span style="background-color: cyan">              _currentMarkerData = layoutState.getCurrentMarkerData();</span><br>      271-&gt;N:  <span style="background-color: white">      </span><br>      272-&gt;N:  <span style="background-color: white">              if (isPrint()) {</span><br>    273-&gt;252:  <span style="background-color: cyan">                  setPageName(layoutState.getPageName());</span><br>      274-&gt;N:  <span style="background-color: white">              }</span><br>      275-&gt;N:  <span style="background-color: white">          }</span><br>      276-&gt;N:  <span style="background-color: white">      </span><br>    277-&gt;256:  <span style="background-color: cyan">          public BlockFormattingContext getBlockFormattingContext() {</span><br>      278-&gt;N:  <span style="background-color: white">              return _bfcs.getLast();</span><br>      279-&gt;N:  <span style="background-color: white">          }</span><br>      280-&gt;N:  <span style="background-color: white">      </span><br>    281-&gt;260:  <span style="background-color: red">          public void pushBFC(BlockFormattingContext bfc) {</span><br>    282-&gt;261:  <span style="background-color: red">              _bfcs.add(bfc);</span><br>      283-&gt;N:  <span style="background-color: white">          }</span><br>      284-&gt;N:  <span style="background-color: white">      </span><br>    285-&gt;264:  <span style="background-color: red">          public void popBFC() {</span><br>      286-&gt;N:  <span style="background-color: white">              _bfcs.removeLast();</span><br>      287-&gt;N:  <span style="background-color: white">          }</span><br>      288-&gt;N:  <span style="background-color: white">      </span><br>      289-&gt;U:  <span style="background-color: yellow">          public void pushLayerIsolated(Box master) {</span><br>      290-&gt;U:  <span style="background-color: yellow">              pushLayer(new Layer(master, this, true));</span><br>      291-&gt;U:  <span style="background-color: yellow">          }</span><br>      292-&gt;N:  <span style="background-color: white">      </span><br>    293-&gt;268:  <span style="background-color: cyan">          public void pushLayer(Box master) {</span><br>    294-&gt;269:  <span style="background-color: cyan">              Layer layer = null;</span><br>      295-&gt;N:  <span style="background-color: white">      </span><br>    296-&gt;271:  <span style="background-color: cyan">              if (_rootLayer == null) {</span><br>    297-&gt;272:  <span style="background-color: cyan">                  layer = new Layer(master, this);</span><br>    298-&gt;273:  <span style="background-color: cyan">                  _rootLayer = layer;</span><br>      299-&gt;N:  <span style="background-color: white">              } else {</span><br>    300-&gt;275:  <span style="background-color: cyan">                  Layer parent = getLayer();</span><br>      301-&gt;N:  <span style="background-color: white">      </span><br>    302-&gt;277:  <span style="background-color: cyan">                  layer = new Layer(parent, master, this);</span><br>      303-&gt;N:  <span style="background-color: white">      </span><br>    304-&gt;279:  <span style="background-color: cyan">                  parent.addChild(layer);</span><br>      305-&gt;N:  <span style="background-color: white">              }</span><br>      306-&gt;N:  <span style="background-color: white">      </span><br>    307-&gt;282:  <span style="background-color: cyan">              pushLayer(layer);</span><br>      308-&gt;N:  <span style="background-color: white">          }</span><br>      309-&gt;N:  <span style="background-color: white">      </span><br>    310-&gt;285:  <span style="background-color: cyan">          public void pushLayer(Layer layer) {</span><br>    311-&gt;286:  <span style="background-color: cyan">              _layers.add(layer);</span><br>      312-&gt;N:  <span style="background-color: white">          }</span><br>      313-&gt;N:  <span style="background-color: white">      </span><br>    314-&gt;289:  <span style="background-color: cyan">          public void popLayer() {</span><br>    315-&gt;290:  <span style="background-color: cyan">              Layer layer = getLayer();</span><br>      316-&gt;N:  <span style="background-color: white">      </span><br>    317-&gt;292:  <span style="background-color: cyan">              layer.finish(this);</span><br>      318-&gt;N:  <span style="background-color: white">      </span><br>      319-&gt;N:  <span style="background-color: white">              _layers.removeLast();</span><br>      320-&gt;N:  <span style="background-color: white">          }</span><br>      321-&gt;N:  <span style="background-color: white">      </span><br>    322-&gt;297:  <span style="background-color: cyan">          public Layer getLayer() {</span><br>      323-&gt;N:  <span style="background-color: white">              return _layers.getLast();</span><br>      324-&gt;N:  <span style="background-color: white">          }</span><br>      325-&gt;N:  <span style="background-color: white">      </span><br>    326-&gt;301:  <span style="background-color: cyan">          public Layer getRootLayer() {</span><br>      327-&gt;N:  <span style="background-color: white">              return _rootLayer;</span><br>      328-&gt;N:  <span style="background-color: white">          }</span><br>      329-&gt;N:  <span style="background-color: white">      </span><br>    330-&gt;305:  <span style="background-color: cyan">          public void translate(int x, int y) {</span><br>    331-&gt;306:  <span style="background-color: cyan">              getBlockFormattingContext().translate(x, y);</span><br>      332-&gt;N:  <span style="background-color: white">          }</span><br>      333-&gt;N:  <span style="background-color: white">      </span><br>      334-&gt;N:  <span style="background-color: white">          /* code to keep track of all of the id'd boxes */</span><br>    335-&gt;310:  <span style="background-color: cyan">          public void addBoxId(String id, Box box) {</span><br>    336-&gt;311:  <span style="background-color: cyan">              _sharedContext.addBoxId(id, box);</span><br>      337-&gt;N:  <span style="background-color: white">          }</span><br>      338-&gt;N:  <span style="background-color: white">      </span><br>    339-&gt;314:  <span style="background-color: cyan">          public void removeBoxId(String id) {</span><br>    340-&gt;315:  <span style="background-color: cyan">              _sharedContext.removeBoxId(id);</span><br>      341-&gt;N:  <span style="background-color: white">          }</span><br>      342-&gt;N:  <span style="background-color: white">      </span><br>    343-&gt;318:  <span style="background-color: white">          public boolean isInteractive() {</span><br>      344-&gt;N:  <span style="background-color: white">              return _sharedContext.isInteractive();</span><br>      345-&gt;N:  <span style="background-color: white">          }</span><br>      346-&gt;N:  <span style="background-color: white">      </span><br>    347-&gt;322:  <span style="background-color: cyan">          public float getMmPerDot() {</span><br>      348-&gt;N:  <span style="background-color: white">              return _sharedContext.getMmPerDotParent();</span><br>      349-&gt;N:  <span style="background-color: white">          }</span><br>      350-&gt;N:  <span style="background-color: white">      </span><br>    351-&gt;326:  <span style="background-color: cyan">          public int getDotsPerPixel() {</span><br>      352-&gt;N:  <span style="background-color: white">              return _sharedContext.getDotsPerPixel();</span><br>      353-&gt;N:  <span style="background-color: white">          }</span><br>      354-&gt;N:  <span style="background-color: white">      </span><br>    355-&gt;330:  <span style="background-color: cyan">          public float getFontSize2D(FontSpecification font) {</span><br>    356-&gt;331:  <span style="background-color: cyan">              return _sharedContext.getFont(font).getSize2D();</span><br>      357-&gt;N:  <span style="background-color: white">          }</span><br>      358-&gt;N:  <span style="background-color: white">      </span><br>    359-&gt;334:  <span style="background-color: white">          public float getXHeight(FontSpecification parentFont) {</span><br>    360-&gt;335:  <span style="background-color: white">              return _sharedContext.getXHeight(getFontContext(), parentFont);</span><br>      361-&gt;N:  <span style="background-color: white">          }</span><br>      362-&gt;N:  <span style="background-color: white">      </span><br>    363-&gt;338:  <span style="background-color: cyan">          public FSFont getFont(FontSpecification font) {</span><br>    364-&gt;339:  <span style="background-color: cyan">              return _sharedContext.getFont(font);</span><br>      365-&gt;N:  <span style="background-color: white">          }</span><br>      366-&gt;N:  <span style="background-color: white">      </span><br>    367-&gt;342:  <span style="background-color: cyan">          public UserAgentCallback getUac() {</span><br>      368-&gt;N:  <span style="background-color: white">              return _sharedContext.getUserAgentCallback();</span><br>      369-&gt;N:  <span style="background-color: white">          }</span><br>      370-&gt;N:  <span style="background-color: white">      </span><br>    371-&gt;346:  <span style="background-color: cyan">          public boolean isPrint() {</span><br>    372-&gt;347:  <span style="background-color: cyan">          	if (this.isPrintOverride != null) {</span><br>      373-&gt;N:  <span style="background-color: white">          		return this.isPrintOverride;</span><br>      374-&gt;N:  <span style="background-color: white">          	}</span><br>      375-&gt;N:  <span style="background-color: white">          	</span><br>      376-&gt;N:  <span style="background-color: white">              return _sharedContext.isPrint();</span><br>      377-&gt;N:  <span style="background-color: white">          }</span><br>      378-&gt;N:  <span style="background-color: white">          </span><br>      379-&gt;N:  <span style="background-color: white">          /**</span><br>      380-&gt;N:  <span style="background-color: white">           * @param isPrint true, false or null for no override.</span><br>      381-&gt;N:  <span style="background-color: white">           */</span><br>    382-&gt;357:  <span style="background-color: cyan">          public void setIsPrintOverride(Boolean isPrint) {</span><br>    383-&gt;358:  <span style="background-color: cyan">          	this.isPrintOverride = isPrint;</span><br>      384-&gt;N:  <span style="background-color: white">          }</span><br>      385-&gt;N:  <span style="background-color: white">      </span><br>    386-&gt;361:  <span style="background-color: cyan">          public StyleTracker getFirstLinesTracker() {</span><br>      387-&gt;N:  <span style="background-color: white">              return _firstLines;</span><br>      388-&gt;N:  <span style="background-color: white">          }</span><br>      389-&gt;N:  <span style="background-color: white">      </span><br>    390-&gt;365:  <span style="background-color: cyan">          public StyleTracker getFirstLettersTracker() {</span><br>      391-&gt;N:  <span style="background-color: white">              return _firstLetters;</span><br>      392-&gt;N:  <span style="background-color: white">          }</span><br>      393-&gt;N:  <span style="background-color: white">      </span><br>    394-&gt;369:  <span style="background-color: cyan">          public MarkerData getCurrentMarkerData() {</span><br>      395-&gt;N:  <span style="background-color: white">              return _currentMarkerData;</span><br>      396-&gt;N:  <span style="background-color: white">          }</span><br>      397-&gt;N:  <span style="background-color: white">      </span><br>    398-&gt;373:  <span style="background-color: cyan">          public void setCurrentMarkerData(MarkerData currentMarkerData) {</span><br>    399-&gt;374:  <span style="background-color: cyan">              _currentMarkerData = currentMarkerData;</span><br>      400-&gt;N:  <span style="background-color: white">          }</span><br>      401-&gt;N:  <span style="background-color: white">      </span><br>    402-&gt;377:  <span style="background-color: cyan">          public ReplacedElementFactory getReplacedElementFactory() {</span><br>      403-&gt;N:  <span style="background-color: white">              return _sharedContext.getReplacedElementFactory();</span><br>      404-&gt;N:  <span style="background-color: white">          }</span><br>      405-&gt;N:  <span style="background-color: white">      </span><br>    406-&gt;381:  <span style="background-color: cyan">          @Override</span><br>    407-&gt;382:  <span style="background-color: white">          public FontContext getFontContext() {</span><br>      408-&gt;N:  <span style="background-color: white">              return _fontContext;</span><br>      409-&gt;N:  <span style="background-color: white">          }</span><br>      410-&gt;N:  <span style="background-color: white">      </span><br>    411-&gt;386:  <span style="background-color: cyan">          public void setFontContext(FontContext fontContext) {</span><br>    412-&gt;387:  <span style="background-color: cyan">              _fontContext = fontContext;</span><br>      413-&gt;N:  <span style="background-color: white">          }</span><br>      414-&gt;N:  <span style="background-color: white">      </span><br>    415-&gt;390:  <span style="background-color: white">          public ContentFunctionFactory getContentFunctionFactory() {</span><br>      416-&gt;N:  <span style="background-color: white">              return _contentFunctionFactory;</span><br>      417-&gt;N:  <span style="background-color: white">          }</span><br>      418-&gt;N:  <span style="background-color: white">      </span><br>    419-&gt;394:  <span style="background-color: cyan">          public SharedContext getSharedContext() {</span><br>      420-&gt;N:  <span style="background-color: white">              return _sharedContext;</span><br>      421-&gt;N:  <span style="background-color: white">          }</span><br>      422-&gt;N:  <span style="background-color: white">      </span><br>      423-&gt;N:  <span style="background-color: white">          /**</span><br>      424-&gt;N:  <span style="background-color: white">           * Returns the extra space set aside for the footers of paginated tables.</span><br>      425-&gt;N:  <span style="background-color: white">           */</span><br>    426-&gt;398:  <span style="background-color: red">          public int getExtraSpaceBottom() {</span><br>      427-&gt;N:  <span style="background-color: white">              return _extraSpaceBottom;</span><br>      428-&gt;N:  <span style="background-color: white">          }</span><br>      429-&gt;N:  <span style="background-color: white">      </span><br>      430-&gt;N:  <span style="background-color: white">          /**</span><br>      431-&gt;N:  <span style="background-color: white">           * See {@link #getExtraSpaceBottom()}</span><br>      432-&gt;N:  <span style="background-color: white">           */</span><br>    433-&gt;402:  <span style="background-color: red">          public void setExtraSpaceBottom(int extraSpaceBottom) {</span><br>    434-&gt;403:  <span style="background-color: red">              _extraSpaceBottom = extraSpaceBottom;</span><br>      435-&gt;N:  <span style="background-color: white">          }</span><br>      436-&gt;N:  <span style="background-color: white">      </span><br>      437-&gt;N:  <span style="background-color: white">          /**</span><br>      438-&gt;N:  <span style="background-color: white">           * Returns the extra space set aside for the head section of paginated tables.</span><br>      439-&gt;N:  <span style="background-color: white">           */</span><br>    440-&gt;406:  <span style="background-color: cyan">          public int getExtraSpaceTop() {</span><br>      441-&gt;N:  <span style="background-color: white">              return _extraSpaceTop;</span><br>      442-&gt;N:  <span style="background-color: white">          }</span><br>      443-&gt;N:  <span style="background-color: white">      </span><br>      444-&gt;N:  <span style="background-color: white">          /**</span><br>      445-&gt;N:  <span style="background-color: white">           * See {@link #getExtraSpaceTop()}</span><br>      446-&gt;N:  <span style="background-color: white">           */</span><br>    447-&gt;410:  <span style="background-color: red">          public void setExtraSpaceTop(int extraSpaceTop) {</span><br>    448-&gt;411:  <span style="background-color: red">              _extraSpaceTop = extraSpaceTop;</span><br>      449-&gt;N:  <span style="background-color: white">          }</span><br>      450-&gt;N:  <span style="background-color: white">      </span><br>      451-&gt;U:  <span style="background-color: yellow">          public void resolveCounters(CalculatedStyle style, Integer startIndex) {</span><br>      452-&gt;U:  <span style="background-color: yellow">              //new context for child elements</span><br>      453-&gt;U:  <span style="background-color: yellow">              CounterContext cc = new CounterContext(this, style, startIndex);</span><br>      454-&gt;U:  <span style="background-color: yellow">              _counterContextMap.put(style, cc);</span><br>      455-&gt;U:  <span style="background-color: yellow">          }</span><br>      456-&gt;N:  <span style="background-color: white">      </span><br>    457-&gt;420:  <span style="background-color: cyan">          public void resolveCounters(CalculatedStyle style) {</span><br>    458-&gt;421:  <span style="background-color: cyan">          	resolveCounters(style, null);</span><br>      459-&gt;N:  <span style="background-color: white">          }</span><br>      460-&gt;N:  <span style="background-color: white">      </span><br>      461-&gt;U:  <span style="background-color: yellow">          public AbstractCounterContext getCounterContext(CalculatedStyle style) {</span><br>    462-&gt;425:  <span style="background-color: white">              return _counterContextMap.get(style);</span><br>      463-&gt;N:  <span style="background-color: white">          }</span><br>      464-&gt;N:  <span style="background-color: white">      </span><br>    465-&gt;428:  <span style="background-color: cyan">          public FSFontMetrics getFSFontMetrics(FSFont font) {</span><br>    466-&gt;429:  <span style="background-color: cyan">              return getTextRenderer().getFSFontMetrics(getFontContext(), font, "");</span><br>      467-&gt;N:  <span style="background-color: white">          }</span><br>      468-&gt;N:  <span style="background-color: white">      </span><br>    469-&gt;556:  <span style="background-color: cyan">          public String getPageName() {</span><br>      470-&gt;N:  <span style="background-color: white">              return _pageName;</span><br>      471-&gt;N:  <span style="background-color: white">          }</span><br>      472-&gt;N:  <span style="background-color: white">      </span><br>    473-&gt;560:  <span style="background-color: cyan">          public void setPageName(String currentPageName) {</span><br>    474-&gt;561:  <span style="background-color: cyan">              _pageName = currentPageName;</span><br>      475-&gt;N:  <span style="background-color: white">          }</span><br>      476-&gt;N:  <span style="background-color: white">      </span><br>    477-&gt;564:  <span style="background-color: cyan">          public int getNoPageBreak() {</span><br>      478-&gt;N:  <span style="background-color: white">              return _noPageBreak;</span><br>      479-&gt;N:  <span style="background-color: white">          }</span><br>      480-&gt;N:  <span style="background-color: white">      </span><br>    481-&gt;568:  <span style="background-color: cyan">          public void setNoPageBreak(int noPageBreak) {</span><br>    482-&gt;569:  <span style="background-color: cyan">              _noPageBreak = noPageBreak;</span><br>      483-&gt;N:  <span style="background-color: white">          }</span><br>      484-&gt;N:  <span style="background-color: white">      </span><br>    485-&gt;572:  <span style="background-color: cyan">          public boolean isPageBreaksAllowed() {</span><br>    486-&gt;573:  <span style="background-color: cyan">              return _noPageBreak == 0;</span><br>      487-&gt;N:  <span style="background-color: white">          }</span><br>      488-&gt;N:  <span style="background-color: white">      </span><br>    489-&gt;576:  <span style="background-color: white">          public String getPendingPageName() {</span><br>      490-&gt;N:  <span style="background-color: white">              return _pendingPageName;</span><br>      491-&gt;N:  <span style="background-color: white">          }</span><br>      492-&gt;N:  <span style="background-color: white">      </span><br>    493-&gt;580:  <span style="background-color: white">          public void setPendingPageName(String pendingPageName) {</span><br>    494-&gt;581:  <span style="background-color: white">              _pendingPageName = pendingPageName;</span><br>      495-&gt;N:  <span style="background-color: white">          }</span><br>      496-&gt;N:  <span style="background-color: white">      </span><br>    497-&gt;584:  <span style="background-color: cyan">          public Layer getRootDocumentLayer() {</span><br>      498-&gt;N:  <span style="background-color: white">              return _rootDocumentLayer;</span><br>      499-&gt;N:  <span style="background-color: white">          }</span><br>      500-&gt;N:  <span style="background-color: white">      </span><br>    501-&gt;588:  <span style="background-color: cyan">          public void setRootDocumentLayer(Layer rootDocumentLayer) {</span><br>    502-&gt;589:  <span style="background-color: cyan">              _rootDocumentLayer = rootDocumentLayer;</span><br>      503-&gt;N:  <span style="background-color: white">          }</span><br>      504-&gt;N:  <span style="background-color: white">      </span><br>    505-&gt;592:  <span style="background-color: cyan">          public PageBox getPage() {</span><br>      506-&gt;N:  <span style="background-color: white">              return _page;</span><br>      507-&gt;N:  <span style="background-color: white">          }</span><br>      508-&gt;N:  <span style="background-color: white">      </span><br>    509-&gt;596:  <span style="background-color: cyan">          public void setPage(PageBox page) {</span><br>    510-&gt;597:  <span style="background-color: cyan">              _page = page;</span><br>      511-&gt;N:  <span style="background-color: white">          }</span><br>      512-&gt;N:  <span style="background-color: white">      </span><br>    513-&gt;600:  <span style="background-color: red">          public boolean isMayCheckKeepTogether() {</span><br>      514-&gt;N:  <span style="background-color: white">              return _mayCheckKeepTogether;</span><br>      515-&gt;N:  <span style="background-color: white">          }</span><br>      516-&gt;N:  <span style="background-color: white">      </span><br>    517-&gt;604:  <span style="background-color: red">          public void setMayCheckKeepTogether(boolean mayKeepTogether) {</span><br>    518-&gt;605:  <span style="background-color: red">              _mayCheckKeepTogether = mayKeepTogether;</span><br>      519-&gt;N:  <span style="background-color: white">          }</span><br>      520-&gt;N:  <span style="background-color: white">      </span><br>      521-&gt;U:  <span style="background-color: yellow">          public void setBlockBoxingState(BlockBoxingState state) {</span><br>      522-&gt;U:  <span style="background-color: yellow">              _blockBoxingState = state;</span><br>      523-&gt;U:  <span style="background-color: yellow">          }</span><br>      524-&gt;N:  <span style="background-color: white">      </span><br>      525-&gt;U:  <span style="background-color: yellow">          public BlockBoxingState getBlockBoxingState() {</span><br>      526-&gt;U:  <span style="background-color: yellow">              return _blockBoxingState;</span><br>      527-&gt;U:  <span style="background-color: yellow">          }</span><br>      528-&gt;N:  <span style="background-color: white">      </span><br>    529-&gt;608:  <span style="background-color: cyan">          public boolean isLineBreakedBecauseOfNoWrap() {</span><br>      530-&gt;N:  <span style="background-color: white">              return _lineBreakedBecauseOfNoWrap;</span><br>      531-&gt;N:  <span style="background-color: white">          }</span><br>      532-&gt;N:  <span style="background-color: white">      </span><br>    533-&gt;612:  <span style="background-color: cyan">          public void setLineBreakedBecauseOfNoWrap(boolean value) {</span><br>    534-&gt;613:  <span style="background-color: cyan">              _lineBreakedBecauseOfNoWrap = value;</span><br>      535-&gt;N:  <span style="background-color: white">          }</span><br>      536-&gt;N:  <span style="background-color: white">      </span><br>    537-&gt;616:  <span style="background-color: cyan">          public BreakAtLineContext getBreakAtLineContext() {</span><br>      538-&gt;N:  <span style="background-color: white">              return _breakAtLineContext;</span><br>      539-&gt;N:  <span style="background-color: white">          }</span><br>      540-&gt;N:  <span style="background-color: white">      </span><br>    541-&gt;620:  <span style="background-color: white">          public void setBreakAtLineContext(BreakAtLineContext breakAtLineContext) {</span><br>    542-&gt;621:  <span style="background-color: white">              _breakAtLineContext = breakAtLineContext;</span><br>      543-&gt;N:  <span style="background-color: white">          }</span><br>      544-&gt;N:  <span style="background-color: white">      </span><br>      545-&gt;N:  <span style="background-color: white">          /**</span><br>      546-&gt;N:  <span style="background-color: white">           * Whether further footnote content is allowed. Used to prohibit</span><br>      547-&gt;N:  <span style="background-color: white">           * footnotes inside footnotes.</span><br>      548-&gt;N:  <span style="background-color: white">           */</span><br>      549-&gt;U:  <span style="background-color: yellow">          public boolean isFootnoteAllowed() {</span><br>      550-&gt;U:  <span style="background-color: yellow">              return _isFootnoteAllowed;</span><br>      551-&gt;U:  <span style="background-color: yellow">          }</span><br>      552-&gt;N:  <span style="background-color: white">      </span><br>      553-&gt;N:  <span style="background-color: white">          /**</span><br>      554-&gt;N:  <span style="background-color: white">           * See {@link #isFootnoteAllowed()}.</span><br>      555-&gt;N:  <span style="background-color: white">           */</span><br>      556-&gt;U:  <span style="background-color: yellow">          public void setFootnoteAllowed(boolean allowed) {</span><br>      557-&gt;U:  <span style="background-color: yellow">              this._isFootnoteAllowed = allowed;</span><br>      558-&gt;U:  <span style="background-color: yellow">          }</span><br>      559-&gt;N:  <span style="background-color: white">      </span><br>      560-&gt;N:  <span style="background-color: white">          /**</span><br>      561-&gt;N:  <span style="background-color: white">           * See {@link #isInFloatBottom()}</span><br>      562-&gt;N:  <span style="background-color: white">           */</span><br>      563-&gt;U:  <span style="background-color: yellow">          public void setIsInFloatBottom(boolean inFloatBottom) {</span><br>      564-&gt;U:  <span style="background-color: yellow">              _isInFloatBottom = inFloatBottom;</span><br>      565-&gt;U:  <span style="background-color: yellow">          }</span><br>      566-&gt;N:  <span style="background-color: white">      </span><br>      567-&gt;N:  <span style="background-color: white">          /**</span><br>      568-&gt;N:  <span style="background-color: white">           * {@inheritDoc}</span><br>      569-&gt;N:  <span style="background-color: white">           */</span><br>      570-&gt;U:  <span style="background-color: yellow">          public boolean isInFloatBottom() {</span><br>      571-&gt;U:  <span style="background-color: yellow">              return _isInFloatBottom;</span><br>      572-&gt;U:  <span style="background-color: yellow">          }</span><br>      573-&gt;N:  <span style="background-color: white">      </span><br>      574-&gt;N:  <span style="background-color: white">          /**</span><br>      575-&gt;N:  <span style="background-color: white">           * See {@link #getFootnoteIndex()}</span><br>      576-&gt;N:  <span style="background-color: white">           */</span><br>      577-&gt;U:  <span style="background-color: yellow">          public void setFootnoteIndex(int footnoteIndex) {</span><br>      578-&gt;U:  <span style="background-color: yellow">              _footnoteIndex = footnoteIndex;</span><br>      579-&gt;U:  <span style="background-color: yellow">          }</span><br>      580-&gt;N:  <span style="background-color: white">      </span><br>      581-&gt;N:  <span style="background-color: white">          /**</span><br>      582-&gt;N:  <span style="background-color: white">           * The zero-based footnote index, which will likely be different from any</span><br>      583-&gt;N:  <span style="background-color: white">           * counter used with the footnote.</span><br>      584-&gt;N:  <span style="background-color: white">           */</span><br>      585-&gt;U:  <span style="background-color: yellow">          public int getFootnoteIndex() {</span><br>      586-&gt;U:  <span style="background-color: yellow">              return _footnoteIndex;</span><br>      587-&gt;U:  <span style="background-color: yellow">          }</span><br>      588-&gt;N:  <span style="background-color: white">      </span><br>      589-&gt;U:  <span style="background-color: yellow">          public boolean hasActiveFootnotes() {</span><br>      590-&gt;U:  <span style="background-color: yellow">              return _footnoteManager != null;</span><br>      591-&gt;U:  <span style="background-color: yellow">          }</span><br>      592-&gt;N:  <span style="background-color: white">      </span><br>      593-&gt;N:  <span style="background-color: white">          /**</span><br>      594-&gt;N:  <span style="background-color: white">           * Gets the document's footnote manager, creating it if required.</span><br>      595-&gt;N:  <span style="background-color: white">           * From the footnote manager, one can add and remove footnote bodies.</span><br>      596-&gt;N:  <span style="background-color: white">           */</span><br>      597-&gt;U:  <span style="background-color: yellow">          public FootnoteManager getFootnoteManager() {</span><br>      598-&gt;U:  <span style="background-color: yellow">              if (_footnoteManager == null) {</span><br>      599-&gt;U:  <span style="background-color: yellow">                  _footnoteManager = new FootnoteManager();</span><br>      600-&gt;U:  <span style="background-color: yellow">              }</span><br>      601-&gt;U:  <span style="background-color: yellow">      </span><br>      602-&gt;U:  <span style="background-color: yellow">              return _footnoteManager;</span><br>      603-&gt;U:  <span style="background-color: yellow">          }</span><br>      604-&gt;N:  <span style="background-color: white">      </span><br>      605-&gt;U:  <span style="background-color: yellow">          public void setFirstLettersTracker(StyleTracker firstLetters) {</span><br>      606-&gt;U:  <span style="background-color: yellow">              _firstLetters = firstLetters;</span><br>      607-&gt;U:  <span style="background-color: yellow">          }</span><br>      608-&gt;N:  <span style="background-color: white">      </span><br>      609-&gt;U:  <span style="background-color: yellow">          public void setFirstLinesTracker(StyleTracker firstLines) {</span><br>      610-&gt;U:  <span style="background-color: yellow">              _firstLines = firstLines;</span><br>      611-&gt;U:  <span style="background-color: yellow">          }</span><br>      612-&gt;N:  <span style="background-color: white">      </span><br>      613-&gt;N:  <span style="background-color: white">      }</span><br></pre> </code> 
   </div> 
  </div>  
 </body>
</html>