<!doctype html>
<html lang="en"> 
 <head> 
  <meta charset="UTF-8"> 
  <title>Execution Trace Diff</title> 
  <meta name="viewport" content="width=device-width, initial-scale=1"> 
  <style>
* {
  box-sizing: border-box;
}

/* Create two equal columns that floats next to each other */
.column {
  float: left;
  width: 50%;
  padding: 10px;
  height: 300px; /* Should be removed. Only for demonstration */
}

/* Clear floats after the columns */
.row:after {
  content: "";
  display: table;
  clear: both;
}

.test {
    border: 1px solid darkblue;
    padding-left: 10px;
}
</style> 
 </head> 
 <body> 
  <div class="row test"> 
   <h2>Differencing Test:</h2> <code> <pre>@Test <br>
public void test_main(){ <br>
    String ret = NumberAnalyzer.analyze(1); <br>
    assertThat(ret, containsString("greater")); <br>
}
        </pre> </code> 
  </div> 
  <div class="row"> 
   <div class="column"> 
    <h2>Original Code:</h2> <code> <pre id="original-trace">           1:  <span style="background-color: white">      package com.openhtmltopdf.util;</span><br>           2:  <span style="background-color: white">      </span><br>           3:  <span style="background-color: white">      import java.util.function.Predicate;</span><br>           4:  <span style="background-color: white">      </span><br>           5:  <span style="background-color: white">      public class LambdaUtil {</span><br>           6:  <span style="background-color: white">   0      private LambdaUtil() { }</span><br>           7:  <span style="background-color: white">          </span><br>           8:  <span style="background-color: white">   0      public static 
       <t>
         Predicate
        <t>
          alwaysTrue() {
        </t>
       </t></span><br>           9:  <span style="background-color: yellow">   0          return (unused) -&gt; true;</span><br>          10:  <span style="background-color: white">          }</span><br>          11:  <span style="background-color: white">          </span><br>          12:  <span style="background-color: white">   0      public static 
       <t>
         Predicate
        <t>
          alwaysFalse() {
        </t>
       </t></span><br>          13:  <span style="background-color: yellow">   0          return (unused) -&gt; false;</span><br>          14:  <span style="background-color: white">          }</span><br>          15:  <span style="background-color: white">      }</span><br></pre> </code> 
   </div> 
   <div class="column"> 
    <h2>Patched Code:</h2> <code> <pre id="patched-trace">        1-&gt;N:  <span style="background-color: white">      package com.openhtmltopdf.util;</span><br>        2-&gt;N:  <span style="background-color: white">      </span><br>        3-&gt;N:  <span style="background-color: white">      import java.util.ArrayList;</span><br>        4-&gt;N:  <span style="background-color: white">      import java.util.List;</span><br>        5-&gt;N:  <span style="background-color: white">      import java.util.Objects;</span><br>        6-&gt;N:  <span style="background-color: white">      import java.util.function.Predicate;</span><br>        7-&gt;N:  <span style="background-color: white">      import java.util.stream.Collectors;</span><br>        8-&gt;N:  <span style="background-color: white">      import java.util.stream.IntStream;</span><br>        9-&gt;N:  <span style="background-color: white">      import java.util.stream.Stream;</span><br>       10-&gt;N:  <span style="background-color: white">      import java.util.stream.StreamSupport;</span><br>       11-&gt;N:  <span style="background-color: white">      </span><br>       12-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.layout.Layer;</span><br>       13-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.render.BlockBox;</span><br>       14-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.render.Box;</span><br>       15-&gt;N:  <span style="background-color: white">      import com.openhtmltopdf.render.InlineLayoutBox;</span><br>       16-&gt;N:  <span style="background-color: white">      </span><br>       17-&gt;N:  <span style="background-color: white">      public class LambdaUtil {</span><br>       18-&gt;N:  <span style="background-color: white">   0      private LambdaUtil() { }</span><br>       19-&gt;N:  <span style="background-color: white">      </span><br>       20-&gt;N:  <span style="background-color: white">          /**</span><br>       21-&gt;N:  <span style="background-color: white">           * Null-safe way to look up the ancestor tree as a stream.</span><br>       22-&gt;N:  <span style="background-color: white">           * Does not include starting box.</span><br>       23-&gt;N:  <span style="background-color: white">           * Will return a empty stream if either bx or bx.getParent() is null.</span><br>       24-&gt;N:  <span style="background-color: white">           */</span><br>       25-&gt;U:  <span style="background-color: yellow">   0      public static Stream
       <box>
         ancestors(Box bx) {
       </box></span><br>       26-&gt;U:  <span style="background-color: yellow">   0          List
       <box>
         list = new ArrayList&lt;&gt;();
       </box></span><br>       27-&gt;U:  <span style="background-color: yellow">   0          while (bx != null &amp;&amp; bx.getParent() != null) {</span><br>       28-&gt;U:  <span style="background-color: yellow">   0              list.add(bx.getParent());</span><br>       29-&gt;U:  <span style="background-color: yellow">   0              bx = bx.getParent();</span><br>       30-&gt;U:  <span style="background-color: yellow">              }</span><br>       31-&gt;U:  <span style="background-color: yellow">   0          return list.stream();</span><br>       32-&gt;U:  <span style="background-color: yellow">          }</span><br>       33-&gt;N:  <span style="background-color: white">      </span><br>       34-&gt;N:  <span style="background-color: white">          /**</span><br>       35-&gt;N:  <span style="background-color: white">           * A stream of all descendant boxes not including</span><br>       36-&gt;N:  <span style="background-color: white">           * InlineText or InlineBox objects.</span><br>       37-&gt;N:  <span style="background-color: white">           *</span><br>       38-&gt;N:  <span style="background-color: white">           * This would usually only be called after layout is concluded</span><br>       39-&gt;N:  <span style="background-color: white">           * as InlineBox objects are converted to one or more InlineLayoutBox</span><br>       40-&gt;N:  <span style="background-color: white">           * during layout.</span><br>       41-&gt;N:  <span style="background-color: white">           * </span><br>       42-&gt;N:  <span style="background-color: white">           * Should be in breadth first order.</span><br>       43-&gt;N:  <span style="background-color: white">           */</span><br>       44-&gt;U:  <span style="background-color: yellow">   0      public static Stream
       <box>
         descendants(Box parent) {
       </box></span><br>       45-&gt;U:  <span style="background-color: yellow">   0          return StreamSupport.stream(new DescendantBoxSpliterator(parent), false);</span><br>       46-&gt;U:  <span style="background-color: yellow">          }</span><br>       47-&gt;N:  <span style="background-color: white">      </span><br>       48-&gt;N:  <span style="background-color: white">          /**</span><br>       49-&gt;N:  <span style="background-color: white">           * See {@link #descendants(Box)}</span><br>       50-&gt;N:  <span style="background-color: white">           */</span><br>       51-&gt;U:  <span style="background-color: yellow">   0      public static List
       <box>
         descendantsList(Box parent) {
       </box></span><br>       52-&gt;U:  <span style="background-color: yellow">   0          return descendants(parent).collect(Collectors.toList());</span><br>       53-&gt;U:  <span style="background-color: yellow">          }</span><br>       54-&gt;N:  <span style="background-color: white">      </span><br>       55-&gt;N:  <span style="background-color: white">          /**</span><br>       56-&gt;N:  <span style="background-color: white">           * Null-safe identity hash code.</span><br>       57-&gt;N:  <span style="background-color: white">           * Debug only.</span><br>       58-&gt;N:  <span style="background-color: white">           */</span><br>       59-&gt;U:  <span style="background-color: yellow">   0      public static String objectId(Object obj) {</span><br>       60-&gt;U:  <span style="background-color: yellow">   0          return obj == null ? "null" : Integer.toHexString(System.identityHashCode(obj));</span><br>       61-&gt;U:  <span style="background-color: yellow">          }</span><br>       62-&gt;N:  <span style="background-color: white">      </span><br>       63-&gt;N:  <span style="background-color: white">          /**</span><br>       64-&gt;N:  <span style="background-color: white">           * Null-safe box description including object id, layer, containing layer and impl class.</span><br>       65-&gt;N:  <span style="background-color: white">           * Debug only.</span><br>       66-&gt;N:  <span style="background-color: white">           */</span><br>       67-&gt;U:  <span style="background-color: yellow">   0      public static String boxDescription(Box box) {</span><br>       68-&gt;U:  <span style="background-color: yellow">   0          if (box != null) {</span><br>       69-&gt;U:  <span style="background-color: yellow">   0              return String.format("%s =&gt; %s, layer = %s, containing = %s, class = %s", </span><br>       70-&gt;U:  <span style="background-color: yellow">                    objectId(box), box, objectId(box.getLayer()), objectId(box.getContainingLayer()), box.getClass().getName());</span><br>       71-&gt;U:  <span style="background-color: yellow">              }</span><br>       72-&gt;U:  <span style="background-color: yellow">      </span><br>       73-&gt;U:  <span style="background-color: yellow">   0          return "[null box]";</span><br>       74-&gt;U:  <span style="background-color: yellow">          }</span><br>       75-&gt;N:  <span style="background-color: white">      </span><br>       76-&gt;N:  <span style="background-color: white">          /**</span><br>       77-&gt;N:  <span style="background-color: white">           * Null-safe layer description including object id, toString and master box description.</span><br>       78-&gt;N:  <span style="background-color: white">           * Debug only.</span><br>       79-&gt;N:  <span style="background-color: white">           */</span><br>       80-&gt;U:  <span style="background-color: yellow">   0      public static String layerDescription(Layer layer) {</span><br>       81-&gt;U:  <span style="background-color: yellow">   0          if (layer != null) {</span><br>       82-&gt;U:  <span style="background-color: yellow">   0              return String.format(</span><br>       83-&gt;U:  <span style="background-color: yellow">                          "%s, master = %s, parent = %s",</span><br>       84-&gt;U:  <span style="background-color: yellow">                          objectId(layer), boxDescription(layer.getMaster()), objectId(layer.getParent()));</span><br>       85-&gt;U:  <span style="background-color: yellow">              }</span><br>       86-&gt;U:  <span style="background-color: yellow">      </span><br>       87-&gt;U:  <span style="background-color: yellow">   0          return "[null layer]";</span><br>       88-&gt;U:  <span style="background-color: yellow">          }</span><br>       89-&gt;N:  <span style="background-color: white">      </span><br>       90-&gt;N:  <span style="background-color: white">          /**</span><br>       91-&gt;N:  <span style="background-color: white">           * Ancestor dump to string including starting box and referenced layers.</span><br>       92-&gt;N:  <span style="background-color: white">           * Debug only.</span><br>       93-&gt;N:  <span style="background-color: white">           */</span><br>       94-&gt;U:  <span style="background-color: yellow">   0      public static String ancestorDump(Box bx) {</span><br>       95-&gt;U:  <span style="background-color: yellow">   0          return</span><br>       96-&gt;U:  <span style="background-color: yellow">                 boxDescription(bx) +</span><br>       97-&gt;U:  <span style="background-color: yellow">                 ancestors(bx)</span><br>       98-&gt;U:  <span style="background-color: yellow">                   .map(LambdaUtil::boxDescription)</span><br>       99-&gt;U:  <span style="background-color: yellow">                   .collect(Collectors.joining("\n    ", "\nANCESTORS = [\n    ", "\n]")) +</span><br>      100-&gt;U:  <span style="background-color: yellow">                 Stream.concat(</span><br>      101-&gt;U:  <span style="background-color: yellow">                     Stream.of(bx.getLayer(), bx.getContainingLayer()),</span><br>      102-&gt;U:  <span style="background-color: yellow">                     ancestors(bx).flatMap(box -&gt; Stream.of(box.getLayer(), box.getContainingLayer()))</span><br>      103-&gt;U:  <span style="background-color: yellow">                 ).filter(Objects::nonNull)</span><br>      104-&gt;U:  <span style="background-color: yellow">                  .distinct()</span><br>      105-&gt;U:  <span style="background-color: yellow">                  .map(LambdaUtil::layerDescription)</span><br>      106-&gt;U:  <span style="background-color: yellow">                  .collect(Collectors.joining("\n    ", "\nREFED LAYERS = [\n    ", "\n]"));</span><br>      107-&gt;U:  <span style="background-color: yellow">          }</span><br>      108-&gt;N:  <span style="background-color: white">      </span><br>      109-&gt;U:  <span style="background-color: yellow">          private static class DescendantContent {</span><br>      110-&gt;U:  <span style="background-color: yellow">              final Object object;</span><br>      111-&gt;U:  <span style="background-color: yellow">              final int indent;</span><br>      112-&gt;U:  <span style="background-color: yellow">      </span><br>      113-&gt;U:  <span style="background-color: yellow">   0          DescendantContent(Object obj, int indent) {</span><br>      114-&gt;U:  <span style="background-color: yellow">   0              this.object = obj;</span><br>      115-&gt;U:  <span style="background-color: yellow">   0              this.indent = indent;</span><br>      116-&gt;U:  <span style="background-color: yellow">              }</span><br>      117-&gt;U:  <span style="background-color: yellow">          }</span><br>      118-&gt;N:  <span style="background-color: white">      </span><br>      119-&gt;U:  <span style="background-color: yellow">   0      private static void descendantDump(Box parent, int indent, List
       <descendantcontent>
         out) {
       </descendantcontent></span><br>      120-&gt;U:  <span style="background-color: yellow">   0          out.add(new DescendantContent(parent, indent));</span><br>      121-&gt;U:  <span style="background-color: yellow">      </span><br>      122-&gt;U:  <span style="background-color: yellow">   0          indent++;</span><br>      123-&gt;U:  <span style="background-color: yellow">      </span><br>      124-&gt;U:  <span style="background-color: yellow">   0          for (Box child : parent.getChildren()) {</span><br>      125-&gt;U:  <span style="background-color: yellow">   0              descendantDump(child, indent, out);</span><br>      126-&gt;U:  <span style="background-color: yellow">              }</span><br>      127-&gt;U:  <span style="background-color: yellow">      </span><br>      128-&gt;U:  <span style="background-color: yellow">   0          if (parent instanceof BlockBox &amp;&amp;</span><br>      129-&gt;U:  <span style="background-color: yellow">                  ((BlockBox) parent).getInlineContent() != null) {</span><br>      130-&gt;U:  <span style="background-color: yellow">   0              for (Object child : ((BlockBox) parent).getInlineContent()) {</span><br>      131-&gt;U:  <span style="background-color: yellow">   0                  if (child instanceof Box) {</span><br>      132-&gt;U:  <span style="background-color: yellow">   0                      descendantDump((Box) child, indent, out);</span><br>      133-&gt;U:  <span style="background-color: yellow">                      } else {</span><br>      134-&gt;U:  <span style="background-color: yellow">   0                      out.add(new DescendantContent(child, indent));</span><br>      135-&gt;U:  <span style="background-color: yellow">                      }</span><br>      136-&gt;U:  <span style="background-color: yellow">                  }</span><br>      137-&gt;U:  <span style="background-color: yellow">              }</span><br>      138-&gt;U:  <span style="background-color: yellow">      </span><br>      139-&gt;U:  <span style="background-color: yellow">   0          if (parent instanceof InlineLayoutBox) {</span><br>      140-&gt;U:  <span style="background-color: yellow">   0              for (Object child : ((InlineLayoutBox) parent).getInlineChildren()) {</span><br>      141-&gt;U:  <span style="background-color: yellow">   0                  if (child instanceof Box) {</span><br>      142-&gt;U:  <span style="background-color: yellow">   0                      descendantDump((Box) child, indent, out);</span><br>      143-&gt;U:  <span style="background-color: yellow">                      } else {</span><br>      144-&gt;U:  <span style="background-color: yellow">   0                      out.add(new DescendantContent(child, indent));</span><br>      145-&gt;U:  <span style="background-color: yellow">                      }</span><br>      146-&gt;U:  <span style="background-color: yellow">                  }</span><br>      147-&gt;U:  <span style="background-color: yellow">              }</span><br>      148-&gt;U:  <span style="background-color: yellow">          }</span><br>      149-&gt;N:  <span style="background-color: white">      </span><br>      150-&gt;N:  <span style="background-color: white">          /**</span><br>      151-&gt;N:  <span style="background-color: white">           * Creates an indented dump of the box tree.</span><br>      152-&gt;N:  <span style="background-color: white">           * Includes both the pre-layout inline-content and if layout</span><br>      153-&gt;N:  <span style="background-color: white">           * has been run, the after layout structure.</span><br>      154-&gt;N:  <span style="background-color: white">           * Debug only.</span><br>      155-&gt;N:  <span style="background-color: white">           */</span><br>      156-&gt;U:  <span style="background-color: yellow">   0      public static String descendantDump(Box root) {</span><br>      157-&gt;U:  <span style="background-color: yellow">   0          StringBuilder spaces = new StringBuilder(100);</span><br>      158-&gt;U:  <span style="background-color: yellow">   0          IntStream.range(0, 100).forEach(unused -&gt; spaces.append(' '));</span><br>      159-&gt;U:  <span style="background-color: yellow">   0          char[] space = new char[100];</span><br>      160-&gt;U:  <span style="background-color: yellow">   0          spaces.getChars(0, spaces.length(), space, 0);</span><br>      161-&gt;U:  <span style="background-color: yellow">      </span><br>      162-&gt;U:  <span style="background-color: yellow">   0          StringBuilder sb = new StringBuilder();</span><br>      163-&gt;U:  <span style="background-color: yellow">   0          List
       <descendantcontent>
         renderObjects = new ArrayList&lt;&gt;();
       </descendantcontent></span><br>      164-&gt;U:  <span style="background-color: yellow">      </span><br>      165-&gt;U:  <span style="background-color: yellow">   0          descendantDump(root, 0, renderObjects);</span><br>      166-&gt;U:  <span style="background-color: yellow">      </span><br>      167-&gt;U:  <span style="background-color: yellow">   0          for (DescendantContent content : renderObjects) {</span><br>      168-&gt;U:  <span style="background-color: yellow">   0              sb.append(space, 0, Math.min(100, content.indent * 4));</span><br>      169-&gt;U:  <span style="background-color: yellow">   0              sb.append(content.object.toString() + " =&gt; " + Integer.toHexString(System.identityHashCode(content.object)));</span><br>      170-&gt;U:  <span style="background-color: yellow">   0              sb.append('\n');</span><br>      171-&gt;U:  <span style="background-color: yellow">              }</span><br>      172-&gt;U:  <span style="background-color: yellow">      </span><br>      173-&gt;U:  <span style="background-color: yellow">   0          return sb.toString();</span><br>      174-&gt;U:  <span style="background-color: yellow">          }</span><br>      175-&gt;N:  <span style="background-color: white">      </span><br>      176-&gt;8:  <span style="background-color: white">   0      public static 
       <t>
         Predicate
        <t>
          alwaysTrue() {
        </t>
       </t></span><br>      177-&gt;U:  <span style="background-color: yellow">   0          return (unused) -&gt; true;</span><br>      178-&gt;N:  <span style="background-color: white">          }</span><br>      179-&gt;N:  <span style="background-color: white">      </span><br>     180-&gt;12:  <span style="background-color: white">   0      public static 
       <t>
         Predicate
        <t>
          alwaysFalse() {
        </t>
       </t></span><br>      181-&gt;U:  <span style="background-color: yellow">   0          return (unused) -&gt; false;</span><br>      182-&gt;N:  <span style="background-color: white">          }</span><br>      183-&gt;N:  <span style="background-color: white">      }</span><br></pre> </code> 
   </div> 
  </div>  
 </body>
</html>