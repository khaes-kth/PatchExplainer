<!doctype html>
<html lang="en"> 
 <head> 
  <meta charset="UTF-8"> 
  <title>Execution Trace Diff</title> 
  <meta name="viewport" content="width=device-width, initial-scale=1"> 
  <style>
* {
  box-sizing: border-box;
}

/* Create two equal columns that floats next to each other */
.column {
  float: left;
  width: 50%;
  padding: 10px;
  height: 300px; /* Should be removed. Only for demonstration */
}

/* Clear floats after the columns */
.row:after {
  content: "";
  display: table;
  clear: both;
}

.test {
    border: 1px solid darkblue;
    padding-left: 10px;
}
</style> 
 </head> 
 <body> 
  <div class="row test"> 
   <h2>Differencing Test:</h2> <code> <pre>@Test <br>
public void test_main(){ <br>
    String ret = NumberAnalyzer.analyze(1); <br>
    assertThat(ret, containsString("greater")); <br>
}
        </pre> </code> 
  </div> 
  <div class="row"> 
   <div class="column"> 
    <h2>Original Code:</h2> <code> <pre id="original-trace">           1:  <span style="background-color: white">      package org.nlpcn.commons.lang.tire.domain;</span><br>           2:  <span style="background-color: white">      </span><br>           3:  <span style="background-color: white">      import java.io.Serializable;</span><br>           4:  <span style="background-color: white">      import java.util.Arrays;</span><br>           5:  <span style="background-color: white">      import java.util.HashMap;</span><br>           6:  <span style="background-color: white">      import java.util.Map;</span><br>           7:  <span style="background-color: white">      </span><br>           8:  <span style="background-color: white">      import org.nlpcn.commons.lang.tire.SmartGetWord;</span><br>           9:  <span style="background-color: white">      </span><br>          10:  <span style="background-color: white">      /**</span><br>          11:  <span style="background-color: white">       * 一个小树,和Forest的区别是.这个在首字也是用二分查找,做过一次优化.达到到达一定量级自动扩展为hash定位 在ansj分词中这个应用是在自适应分词</span><br>          12:  <span style="background-color: white">       *</span><br>          13:  <span style="background-color: white">       * @author ansj</span><br>          14:  <span style="background-color: white">       */</span><br>          15:  <span style="background-color: white">      public class SmartForest
       <t>
         implements Comparable
        <smartforest>
         <t>
          &gt; , Serializable {
         </t>
        </smartforest>
       </t></span><br>          16:  <span style="background-color: white">      </span><br>          17:  <span style="background-color: white">      	private static final long serialVersionUID = -6088248882078972772L;</span><br>          18:  <span style="background-color: white">      	</span><br>          19:  <span style="background-color: white">      	private static final int MAX_SIZE = 65536;</span><br>          20:  <span style="background-color: white">      	/**</span><br>          21:  <span style="background-color: white">      	 * status 此字的状态1，继续 2，是个词语但是还可以继续 ,3确定 nature 词语性质</span><br>          22:  <span style="background-color: white">      	 */</span><br>          23:  <span style="background-color: white">      	public SmartForest
       <t>
        [] branches = null;
       </t></span><br>          24:  <span style="background-color: white">      	// 单独查找出来的对象</span><br>          25:  <span style="background-color: white">      	SmartForest
       <t>
         branch = null;
       </t></span><br>          26:  <span style="background-color: white">      	private double rate = 0.9;</span><br>          27:  <span style="background-color: white">      	private char c;</span><br>          28:  <span style="background-color: white">      	// 状态</span><br>          29:  <span style="background-color: white">      	private byte status = 1;</span><br>          30:  <span style="background-color: white">      	// 词典后的参数</span><br>          31:  <span style="background-color: white">      	private T param = null;</span><br>          32:  <span style="background-color: white">      </span><br>          33:  <span style="background-color: white">      	// root</span><br>          34:  <span style="background-color: white">      	public SmartForest() {</span><br>          35:  <span style="background-color: white">      	}</span><br>          36:  <span style="background-color: white">      </span><br>          37:  <span style="background-color: white">      	// 首位直接数组定位</span><br>          38:  <span style="background-color: white">      	@SuppressWarnings("unchecked")</span><br>          39:  <span style="background-color: white">      	public SmartForest(double rate) {</span><br>          40:  <span style="background-color: white">      		branches = new SmartForest[MAX_SIZE];</span><br>          41:  <span style="background-color: white">      		this.rate = rate;</span><br>          42:  <span style="background-color: white">      	}</span><br>          43:  <span style="background-color: white">      </span><br>          44:  <span style="background-color: white">      	// temp branch</span><br>          45:  <span style="background-color: white">      	private SmartForest(char c) {</span><br>          46:  <span style="background-color: white">      		this.c = c;</span><br>          47:  <span style="background-color: white">      	}</span><br>          48:  <span style="background-color: white">      </span><br>          49:  <span style="background-color: white">      	public SmartForest(char c, int status, T param) {</span><br>          50:  <span style="background-color: white">      		this.c = c;</span><br>          51:  <span style="background-color: white">      		this.status = (byte) status;</span><br>          52:  <span style="background-color: white">      		this.param = param;</span><br>          53:  <span style="background-color: white">      	}</span><br>          54:  <span style="background-color: white">      </span><br>          55:  <span style="background-color: white">      	/**</span><br>          56:  <span style="background-color: white">      	 * 增加子页节点</span><br>          57:  <span style="background-color: white">      	 *</span><br>          58:  <span style="background-color: white">      	 * @param branch</span><br>          59:  <span style="background-color: white">      	 * @return</span><br>          60:  <span style="background-color: white">      	 */</span><br>          61:  <span style="background-color: white">      	@SuppressWarnings("unchecked")</span><br>          62:  <span style="background-color: white">      	public synchronized SmartForest
       <t>
         add(SmartForest
        <t>
          branch) {
        </t>
       </t></span><br>          63:  <span style="background-color: white">      		if (branches == null) {</span><br>          64:  <span style="background-color: white">      			branches = new SmartForest[0];</span><br>          65:  <span style="background-color: white">      		}</span><br>          66:  <span style="background-color: white">      		int bs = getIndex(branch.getC());</span><br>          67:  <span style="background-color: white">      		if (bs &gt; -1) {</span><br>          68:  <span style="background-color: white">      			if (this.branches[bs] == null) {</span><br>          69:  <span style="background-color: white">      				this.branches[bs] = branch;</span><br>          70:  <span style="background-color: white">      			}</span><br>          71:  <span style="background-color: white">      			this.branch = this.branches[bs];</span><br>          72:  <span style="background-color: white">      			switch (branch.getStatus()) {</span><br>          73:  <span style="background-color: white">      			case -1:</span><br>          74:  <span style="background-color: white">      				this.branch.setStatus(1);</span><br>          75:  <span style="background-color: white">      				break;</span><br>          76:  <span style="background-color: white">      			case 1:</span><br>          77:  <span style="background-color: white">      				if (this.branch.getStatus() == 3) {</span><br>          78:  <span style="background-color: white">      					this.branch.setStatus(2);</span><br>          79:  <span style="background-color: white">      				}</span><br>          80:  <span style="background-color: white">      				break;</span><br>          81:  <span style="background-color: white">      			case 3:</span><br>          82:  <span style="background-color: white">      				if (this.branch.getStatus() != 3) {</span><br>          83:  <span style="background-color: white">      					this.branch.setStatus(2);</span><br>          84:  <span style="background-color: white">      				}</span><br>          85:  <span style="background-color: white">      				this.branch.setParam(branch.getParam());</span><br>          86:  <span style="background-color: white">      </span><br>          87:  <span style="background-color: white">      			}</span><br>          88:  <span style="background-color: white">      			return this.branch;</span><br>          89:  <span style="background-color: white">      		}</span><br>          90:  <span style="background-color: white">      </span><br>          91:  <span style="background-color: white">      		if (bs &lt; 0) {</span><br>          92:  <span style="background-color: white">      			// 如果数组内元素接近于最大值直接数组定位，rate是内存和速度的一个平衡</span><br>          93:  <span style="background-color: white">      			if (branches != null &amp;&amp; branches.length &gt;= MAX_SIZE * rate) {</span><br>          94:  <span style="background-color: white">      				SmartForest
       <t>
        [] tempBranches = new SmartForest[MAX_SIZE];
       </t></span><br>          95:  <span style="background-color: white">      				for (SmartForest
       <t>
         b : branches) {
       </t></span><br>          96:  <span style="background-color: white">      					tempBranches[b.getC()] = b;</span><br>          97:  <span style="background-color: white">      				}</span><br>          98:  <span style="background-color: white">      				tempBranches[branch.getC()] = branch;</span><br>          99:  <span style="background-color: white">      				branches = null;</span><br>         100:  <span style="background-color: white">      				branches = tempBranches;</span><br>         101:  <span style="background-color: white">      			} else {</span><br>         102:  <span style="background-color: white">      				SmartForest
       <t>
        [] newBranches = new SmartForest[branches.length + 1];
       </t></span><br>         103:  <span style="background-color: white">      				int insert = -(bs + 1);</span><br>         104:  <span style="background-color: white">      				System.arraycopy(this.branches, 0, newBranches, 0, insert);</span><br>         105:  <span style="background-color: white">      				System.arraycopy(branches, insert, newBranches, insert + 1, branches.length - insert);</span><br>         106:  <span style="background-color: white">      				newBranches[insert] = branch;</span><br>         107:  <span style="background-color: white">      				this.branches = newBranches;</span><br>         108:  <span style="background-color: white">      			}</span><br>         109:  <span style="background-color: white">      </span><br>         110:  <span style="background-color: white">      		}</span><br>         111:  <span style="background-color: white">      		return branch;</span><br>         112:  <span style="background-color: white">      	}</span><br>         113:  <span style="background-color: white">      </span><br>         114:  <span style="background-color: white">      	public int getIndex(char c) {</span><br>         115:  <span style="background-color: white">      		if (branches == null) {</span><br>         116:  <span style="background-color: white">      			return -1;</span><br>         117:  <span style="background-color: white">      		}</span><br>         118:  <span style="background-color: white">      		if (branches.length == MAX_SIZE) {</span><br>         119:  <span style="background-color: white">      			return c;</span><br>         120:  <span style="background-color: white">      		}</span><br>         121:  <span style="background-color: white">      		int i = Arrays.binarySearch(this.branches, new SmartForest
       <t>
        (c));
       </t></span><br>         122:  <span style="background-color: white">      		return i;</span><br>         123:  <span style="background-color: white">      	}</span><br>         124:  <span style="background-color: white">      </span><br>         125:  <span style="background-color: white">      	/**</span><br>         126:  <span style="background-color: white">      	 * 二分查找是否包含</span><br>         127:  <span style="background-color: white">      	 *</span><br>         128:  <span style="background-color: white">      	 * @param c</span><br>         129:  <span style="background-color: white">      	 * @return</span><br>         130:  <span style="background-color: white">      	 */</span><br>         131:  <span style="background-color: white">      	public boolean contains(char c) {</span><br>         132:  <span style="background-color: white">      		if (this.branches == null) {</span><br>         133:  <span style="background-color: white">      			return false;</span><br>         134:  <span style="background-color: white">      		}</span><br>         135:  <span style="background-color: white">      		return Arrays.binarySearch(this.branches, c) &gt; -1;</span><br>         136:  <span style="background-color: white">      	}</span><br>         137:  <span style="background-color: white">      </span><br>         138:  <span style="background-color: white">      	public int compareTo(char c) {</span><br>         139:  <span style="background-color: white">      		if (this.c &gt; c) {</span><br>         140:  <span style="background-color: white">      			return 1;</span><br>         141:  <span style="background-color: white">      		}</span><br>         142:  <span style="background-color: white">      		if (this.c &lt; c) {</span><br>         143:  <span style="background-color: white">      			return -1;</span><br>         144:  <span style="background-color: white">      		}</span><br>         145:  <span style="background-color: white">      		return 0;</span><br>         146:  <span style="background-color: white">      	}</span><br>         147:  <span style="background-color: white">      </span><br>         148:  <span style="background-color: white">      	public boolean equals(char c) {</span><br>         149:  <span style="background-color: white">      		return this.c == c;</span><br>         150:  <span style="background-color: white">      	}</span><br>         151:  <span style="background-color: white">      </span><br>         152:  <span style="background-color: white">      	@Override</span><br>         153:  <span style="background-color: white">      	public int hashCode() {</span><br>         154:  <span style="background-color: white">      		return this.c;</span><br>         155:  <span style="background-color: white">      	}</span><br>         156:  <span style="background-color: white">      </span><br>         157:  <span style="background-color: white">      	public byte getStatus() {</span><br>         158:  <span style="background-color: white">      		return this.status;</span><br>         159:  <span style="background-color: white">      	}</span><br>         160:  <span style="background-color: white">      </span><br>         161:  <span style="background-color: white">      	public void setStatus(int status) {</span><br>         162:  <span style="background-color: white">      		this.status = (byte) status;</span><br>         163:  <span style="background-color: white">      	}</span><br>         164:  <span style="background-color: white">      </span><br>         165:  <span style="background-color: white">      	public char getC() {</span><br>         166:  <span style="background-color: white">      		return this.c;</span><br>         167:  <span style="background-color: white">      	}</span><br>         168:  <span style="background-color: white">      </span><br>         169:  <span style="background-color: white">      	public T getParam() {</span><br>         170:  <span style="background-color: white">      		return this.param;</span><br>         171:  <span style="background-color: white">      	}</span><br>         172:  <span style="background-color: white">      </span><br>         173:  <span style="background-color: white">      	public void setParam(T param) {</span><br>         174:  <span style="background-color: white">      		this.param = param;</span><br>         175:  <span style="background-color: white">      	}</span><br>         176:  <span style="background-color: white">      </span><br>         177:  <span style="background-color: white">      	/**</span><br>         178:  <span style="background-color: white">      	 * 增加新词</span><br>         179:  <span style="background-color: white">      	 *</span><br>         180:  <span style="background-color: white">      	 * @param</span><br>         181:  <span style="background-color: white">      	 */</span><br>         182:  <span style="background-color: white">      	public void add(String keyWord, T t) {</span><br>         183:  <span style="background-color: white">      		SmartForest
       <t>
         tempBranch = this;
       </t></span><br>         184:  <span style="background-color: white">      		for (int i = 0; i &lt; keyWord.length(); i++) {</span><br>         185:  <span style="background-color: white">      			if (keyWord.length() == i + 1) {</span><br>         186:  <span style="background-color: white">      				tempBranch.add(new SmartForest
       <t>
        (keyWord.charAt(i), 3, t));
       </t></span><br>         187:  <span style="background-color: white">      			} else {</span><br>         188:  <span style="background-color: white">      				tempBranch.add(new SmartForest
       <t>
        (keyWord.charAt(i), 1, null));
       </t></span><br>         189:  <span style="background-color: white">      			}</span><br>         190:  <span style="background-color: white">      			tempBranch = tempBranch.branches[tempBranch.getIndex(keyWord.charAt(i))];</span><br>         191:  <span style="background-color: white">      		}</span><br>         192:  <span style="background-color: white">      	}</span><br>         193:  <span style="background-color: white">      </span><br>         194:  <span style="background-color: white">      	/**</span><br>         195:  <span style="background-color: white">      	 * 增加一个元素到节点</span><br>         196:  <span style="background-color: white">      	 * </span><br>         197:  <span style="background-color: white">      	 * @param keyWord</span><br>         198:  <span style="background-color: white">      	 * @param t</span><br>         199:  <span style="background-color: white">      	 */</span><br>         200:  <span style="background-color: white">      	public void addBranch(String keyWord, T t) {</span><br>         201:  <span style="background-color: white">      		this.add(keyWord, t);</span><br>         202:  <span style="background-color: white">      	}</span><br>         203:  <span style="background-color: white">      </span><br>         204:  <span style="background-color: white">      	@Override</span><br>         205:  <span style="background-color: white">      	public int compareTo(SmartForest
       <t>
         o) {
       </t></span><br>         206:  <span style="background-color: white">      		if (this.c &gt; o.c) {</span><br>         207:  <span style="background-color: white">      			return 1;</span><br>         208:  <span style="background-color: white">      		}</span><br>         209:  <span style="background-color: white">      		if (this.c &lt; o.c) {</span><br>         210:  <span style="background-color: white">      			return -1;</span><br>         211:  <span style="background-color: white">      		}</span><br>         212:  <span style="background-color: white">      		return 0;</span><br>         213:  <span style="background-color: white">      	}</span><br>         214:  <span style="background-color: white">      </span><br>         215:  <span style="background-color: white">      	public SmartForest
       <t>
         get(char c) {
       </t></span><br>         216:  <span style="background-color: white">      		return getBranch(c);</span><br>         217:  <span style="background-color: white">      	}</span><br>         218:  <span style="background-color: white">      </span><br>         219:  <span style="background-color: white">      	public SmartForest
       <t>
         getBranch(char c) {
       </t></span><br>         220:  <span style="background-color: white">      		int index = getIndex(c);</span><br>         221:  <span style="background-color: white">      		if (index &lt; 0) {</span><br>         222:  <span style="background-color: white">      			return null;</span><br>         223:  <span style="background-color: white">      		} else {</span><br>         224:  <span style="background-color: white">      			return branches[index];</span><br>         225:  <span style="background-color: white">      		}</span><br>         226:  <span style="background-color: white">      	}</span><br>         227:  <span style="background-color: white">      </span><br>         228:  <span style="background-color: white">      	/**</span><br>         229:  <span style="background-color: white">      	 * 根据一个词获得所取的参数,没有就返回null</span><br>         230:  <span style="background-color: white">      	 *</span><br>         231:  <span style="background-color: white">      	 * @param keyWord</span><br>         232:  <span style="background-color: white">      	 */</span><br>         233:  <span style="background-color: white">      	public SmartForest
       <t>
         getBranch(String keyWord) {
       </t></span><br>         234:  <span style="background-color: white">      		SmartForest
       <t>
         tempBranch = this;
       </t></span><br>         235:  <span style="background-color: white">      		int index = 0;</span><br>         236:  <span style="background-color: white">      		for (int j = 0; j &lt; keyWord.length(); j++) {</span><br>         237:  <span style="background-color: white">      			index = tempBranch.getIndex(keyWord.charAt(j));</span><br>         238:  <span style="background-color: white">      			if (index &lt; 0) {</span><br>         239:  <span style="background-color: white">      				return null;</span><br>         240:  <span style="background-color: white">      			}</span><br>         241:  <span style="background-color: white">      			if ((tempBranch = tempBranch.branches[index]) == null) {</span><br>         242:  <span style="background-color: white">      				return null;</span><br>         243:  <span style="background-color: white">      			}</span><br>         244:  <span style="background-color: white">      </span><br>         245:  <span style="background-color: white">      		}</span><br>         246:  <span style="background-color: white">      		return tempBranch;</span><br>         247:  <span style="background-color: white">      	}</span><br>         248:  <span style="background-color: white">      </span><br>         249:  <span style="background-color: white">      	/**</span><br>         250:  <span style="background-color: white">      	 * 根据一个词获得所取的参数,没有就返回null</span><br>         251:  <span style="background-color: white">      	 *</span><br>         252:  <span style="background-color: white">      	 * @param chars</span><br>         253:  <span style="background-color: white">      	 */</span><br>         254:  <span style="background-color: white">      	public SmartForest
       <t>
         getBranch(char[] chars) {
       </t></span><br>         255:  <span style="background-color: white">      		SmartForest
       <t>
         tempBranch = this;
       </t></span><br>         256:  <span style="background-color: white">      		int index = 0;</span><br>         257:  <span style="background-color: white">      		for (int j = 0; j &lt; chars.length; j++) {</span><br>         258:  <span style="background-color: white">      			index = tempBranch.getIndex(chars[j]);</span><br>         259:  <span style="background-color: white">      			if (index &lt; 0) {</span><br>         260:  <span style="background-color: white">      				return null;</span><br>         261:  <span style="background-color: white">      			}</span><br>         262:  <span style="background-color: white">      			if ((tempBranch = tempBranch.branches[index]) == null) {</span><br>         263:  <span style="background-color: white">      				return null;</span><br>         264:  <span style="background-color: white">      			}</span><br>         265:  <span style="background-color: white">      </span><br>         266:  <span style="background-color: white">      		}</span><br>         267:  <span style="background-color: white">      		return tempBranch;</span><br>         268:  <span style="background-color: white">      	}</span><br>         269:  <span style="background-color: white">      </span><br>         270:  <span style="background-color: white">      	public SmartGetWord
       <t>
         getWord(String str) {
       </t></span><br>         271:  <span style="background-color: white">      		return getWord(str.toCharArray());</span><br>         272:  <span style="background-color: white">      	}</span><br>         273:  <span style="background-color: white">      </span><br>         274:  <span style="background-color: white">      	/**</span><br>         275:  <span style="background-color: white">      	 * 得到抽詞器</span><br>         276:  <span style="background-color: white">      	 * </span><br>         277:  <span style="background-color: white">      	 * @param chars</span><br>         278:  <span style="background-color: white">      	 * @return</span><br>         279:  <span style="background-color: white">      	 */</span><br>         280:  <span style="background-color: white">      	public SmartGetWord
       <t>
         getWord(char[] chars) {
       </t></span><br>         281:  <span style="background-color: white">      		return new SmartGetWord
       <t>
        (this, chars);
       </t></span><br>         282:  <span style="background-color: white">      	}</span><br>         283:  <span style="background-color: white">      </span><br>         284:  <span style="background-color: white">      	/**</span><br>         285:  <span style="background-color: white">      	 * 取得所有的分支</span><br>         286:  <span style="background-color: white">      	 * </span><br>         287:  <span style="background-color: white">      	 * @return</span><br>         288:  <span style="background-color: white">      	 */</span><br>         289:  <span style="background-color: white">      	public SmartForest
       <t>
        [] getBranches() {
       </t></span><br>         290:  <span style="background-color: white">      		return branches;</span><br>         291:  <span style="background-color: white">      	}</span><br>         292:  <span style="background-color: white">      </span><br>         293:  <span style="background-color: white">      	/**</span><br>         294:  <span style="background-color: white">      	 * 删除一个词语</span><br>         295:  <span style="background-color: white">      	 * </span><br>         296:  <span style="background-color: white">      	 * @param string</span><br>         297:  <span style="background-color: white">      	 */</span><br>         298:  <span style="background-color: white">      	public void remove(String word) {</span><br>         299:  <span style="background-color: white">      		getBranch(word).status = 1;</span><br>         300:  <span style="background-color: white">      		getBranch(word).param = null ;</span><br>         301:  <span style="background-color: white">      	}</span><br>         302:  <span style="background-color: white">      </span><br>         303:  <span style="background-color: white">      	/**</span><br>         304:  <span style="background-color: white">      	 * 清空</span><br>         305:  <span style="background-color: white">      	 */</span><br>         306:  <span style="background-color: white">      	@SuppressWarnings("unchecked")</span><br>         307:  <span style="background-color: white">      	public void clear() {</span><br>         308:  <span style="background-color: white">      		branches = new SmartForest[MAX_SIZE];</span><br>         309:  <span style="background-color: white">      	}</span><br>         310:  <span style="background-color: white">      </span><br>         311:  <span style="background-color: white">      	/**</span><br>         312:  <span style="background-color: white">      	 * 将树转换为map</span><br>         313:  <span style="background-color: white">      	 * </span><br>         314:  <span style="background-color: white">      	 * @return map
       <string,object></string,object></span><br>         315:  <span style="background-color: white">      	 */</span><br>         316:  <span style="background-color: white">      	public Map
       <string, t>
         toMap() {
       </string,></span><br>         317:  <span style="background-color: white">      </span><br>         318:  <span style="background-color: white">      		HashMap
       <string, t>
         result = new HashMap
        <string, t>
         ();
        </string,>
       </string,></span><br>         319:  <span style="background-color: white">      </span><br>         320:  <span style="background-color: white">      		if (this.branches == null) {</span><br>         321:  <span style="background-color: white">      			return result;</span><br>         322:  <span style="background-color: white">      		}</span><br>         323:  <span style="background-color: white">      </span><br>         324:  <span style="background-color: white">      		putMap(result, "", this.branches);</span><br>         325:  <span style="background-color: white">      </span><br>         326:  <span style="background-color: white">      		return result;</span><br>         327:  <span style="background-color: white">      	}</span><br>         328:  <span style="background-color: white">      </span><br>         329:  <span style="background-color: white">      	</span><br>         330:  <span style="background-color: white">      	private void putMap(HashMap
       <string, t>
         result, String pre, SmartForest
        <t>
         [] branches) {
        </t>
       </string,></span><br>         331:  <span style="background-color: white">      		if (branches == null) {</span><br>         332:  <span style="background-color: white">      			return;</span><br>         333:  <span style="background-color: white">      		}</span><br>         334:  <span style="background-color: white">      </span><br>         335:  <span style="background-color: white">      		String key = null;</span><br>         336:  <span style="background-color: white">      		SmartForest
       <t>
         sf = null;
       </t></span><br>         337:  <span style="background-color: white">      		for (int i = 0; i &lt; branches.length; i++) {</span><br>         338:  <span style="background-color: white">      			sf = branches[i];</span><br>         339:  <span style="background-color: white">      			if (sf == null) {</span><br>         340:  <span style="background-color: white">      				continue;</span><br>         341:  <span style="background-color: white">      			}</span><br>         342:  <span style="background-color: white">      			key = pre + branches[i].c;</span><br>         343:  <span style="background-color: white">      			if (branches[i].getStatus() == 3) {</span><br>         344:  <span style="background-color: white">      				result.put(key, branches[i].getParam());</span><br>         345:  <span style="background-color: white">      			} else if (branches[i].getStatus() == 2) {</span><br>         346:  <span style="background-color: white">      				result.put(key, branches[i].getParam());</span><br>         347:  <span style="background-color: white">      				putMap(result, key, sf.branches);</span><br>         348:  <span style="background-color: white">      			} else {</span><br>         349:  <span style="background-color: white">      				putMap(result, key, sf.branches);</span><br>         350:  <span style="background-color: white">      			}</span><br>         351:  <span style="background-color: white">      		}</span><br>         352:  <span style="background-color: white">      	}</span><br>         353:  <span style="background-color: white">      </span><br>         354:  <span style="background-color: white">      }</span><br></pre> </code> 
   </div> 
   <div class="column"> 
    <h2>Patched Code:</h2> <code> <pre id="patched-trace">        1-&gt;N:  <span style="background-color: white">      package org.nlpcn.commons.lang.tire.domain;</span><br>        2-&gt;N:  <span style="background-color: white">      </span><br>        3-&gt;N:  <span style="background-color: white">      import java.io.Serializable;</span><br>        4-&gt;N:  <span style="background-color: white">      import java.util.Arrays;</span><br>        5-&gt;N:  <span style="background-color: white">      import java.util.HashMap;</span><br>        6-&gt;N:  <span style="background-color: white">      import java.util.Map;</span><br>        7-&gt;N:  <span style="background-color: white">      </span><br>        8-&gt;N:  <span style="background-color: white">      import org.nlpcn.commons.lang.tire.SmartGetWord;</span><br>        9-&gt;N:  <span style="background-color: white">      </span><br>       10-&gt;N:  <span style="background-color: white">      /**</span><br>       11-&gt;N:  <span style="background-color: white">       * 一个小树,和Forest的区别是.这个在首字也是用二分查找,做过一次优化.达到到达一定量级自动扩展为hash定位 在ansj分词中这个应用是在自适应分词</span><br>       12-&gt;N:  <span style="background-color: white">       *</span><br>       13-&gt;N:  <span style="background-color: white">       * @author ansj</span><br>       14-&gt;N:  <span style="background-color: white">       */</span><br>      15-&gt;15:  <span style="background-color: white">      public class SmartForest
       <t>
         implements Comparable
        <smartforest>
         <t>
          &gt; , Serializable {
         </t>
        </smartforest>
       </t></span><br>       16-&gt;N:  <span style="background-color: white">      </span><br>      17-&gt;17:  <span style="background-color: white">      	private static final long serialVersionUID = -6088248882078972772L;</span><br>       18-&gt;N:  <span style="background-color: white">      	</span><br>      19-&gt;19:  <span style="background-color: white">      	private static final int MAX_SIZE = 65536;</span><br>       20-&gt;N:  <span style="background-color: white">      	/**</span><br>       21-&gt;N:  <span style="background-color: white">      	 * status 此字的状态1，继续 2，是个词语但是还可以继续 ,3确定 nature 词语性质</span><br>       22-&gt;N:  <span style="background-color: white">      	 */</span><br>      23-&gt;23:  <span style="background-color: white">      	public volatile SmartForest
       <t>
        [] branches = null;
       </t></span><br>       24-&gt;N:  <span style="background-color: white">      	// 单独查找出来的对象</span><br>      25-&gt;25:  <span style="background-color: white">      	SmartForest
       <t>
         branch = null;
       </t></span><br>      26-&gt;26:  <span style="background-color: white">      	private double rate = 0.9;</span><br>      27-&gt;27:  <span style="background-color: white">      	private char c;</span><br>       28-&gt;N:  <span style="background-color: white">      	// 状态</span><br>      29-&gt;29:  <span style="background-color: white">      	private byte status = 1;</span><br>       30-&gt;N:  <span style="background-color: white">      	// 词典后的参数</span><br>      31-&gt;31:  <span style="background-color: white">      	private T param = null;</span><br>       32-&gt;N:  <span style="background-color: white">      </span><br>       33-&gt;N:  <span style="background-color: white">      	// root</span><br>       34-&gt;N:  <span style="background-color: white">      	public SmartForest() {</span><br>       35-&gt;N:  <span style="background-color: white">      	}</span><br>       36-&gt;N:  <span style="background-color: white">      </span><br>       37-&gt;N:  <span style="background-color: white">      	// 首位直接数组定位</span><br>      38-&gt;38:  <span style="background-color: white">      	@SuppressWarnings("unchecked")</span><br>      39-&gt;39:  <span style="background-color: white">      	public SmartForest(double rate) {</span><br>      40-&gt;40:  <span style="background-color: white">      		branches = new SmartForest[MAX_SIZE];</span><br>      41-&gt;41:  <span style="background-color: white">      		this.rate = rate;</span><br>       42-&gt;N:  <span style="background-color: white">      	}</span><br>       43-&gt;N:  <span style="background-color: white">      </span><br>       44-&gt;N:  <span style="background-color: white">      	// temp branch</span><br>      45-&gt;45:  <span style="background-color: white">      	private SmartForest(char c) {</span><br>      46-&gt;46:  <span style="background-color: white">      		this.c = c;</span><br>       47-&gt;N:  <span style="background-color: white">      	}</span><br>       48-&gt;N:  <span style="background-color: white">      </span><br>      49-&gt;49:  <span style="background-color: white">      	public SmartForest(char c, int status, T param) {</span><br>      50-&gt;50:  <span style="background-color: white">      		this.c = c;</span><br>      51-&gt;51:  <span style="background-color: white">      		this.status = (byte) status;</span><br>      52-&gt;52:  <span style="background-color: white">      		this.param = param;</span><br>       53-&gt;N:  <span style="background-color: white">      	}</span><br>       54-&gt;N:  <span style="background-color: white">      </span><br>       55-&gt;N:  <span style="background-color: white">      	/**</span><br>       56-&gt;N:  <span style="background-color: white">      	 * 增加子页节点</span><br>       57-&gt;N:  <span style="background-color: white">      	 *</span><br>       58-&gt;N:  <span style="background-color: white">      	 * @param branch</span><br>       59-&gt;N:  <span style="background-color: white">      	 * @return</span><br>       60-&gt;N:  <span style="background-color: white">      	 */</span><br>      61-&gt;61:  <span style="background-color: white">      	@SuppressWarnings("unchecked")</span><br>      62-&gt;62:  <span style="background-color: white">      	public synchronized SmartForest
       <t>
         add(SmartForest
        <t>
          branch) {
        </t>
       </t></span><br>      63-&gt;63:  <span style="background-color: white">      		if (branches == null) {</span><br>      64-&gt;64:  <span style="background-color: white">      			branches = new SmartForest[0];</span><br>       65-&gt;N:  <span style="background-color: white">      		}</span><br>      66-&gt;66:  <span style="background-color: white">      		int bs = getIndex(branch.getC());</span><br>      67-&gt;67:  <span style="background-color: white">      		if (bs &gt; -1) {</span><br>      68-&gt;68:  <span style="background-color: white">      			if (this.branches[bs] == null) {</span><br>      69-&gt;69:  <span style="background-color: white">      				this.branches[bs] = branch;</span><br>       70-&gt;N:  <span style="background-color: white">      			}</span><br>      71-&gt;71:  <span style="background-color: white">      			this.branch = this.branches[bs];</span><br>      72-&gt;72:  <span style="background-color: white">      			switch (branch.getStatus()) {</span><br>      73-&gt;73:  <span style="background-color: white">      			case -1:</span><br>      74-&gt;74:  <span style="background-color: white">      				this.branch.setStatus(1);</span><br>      75-&gt;75:  <span style="background-color: white">      				break;</span><br>      76-&gt;76:  <span style="background-color: white">      			case 1:</span><br>      77-&gt;77:  <span style="background-color: white">      				if (this.branch.getStatus() == 3) {</span><br>      78-&gt;78:  <span style="background-color: white">      					this.branch.setStatus(2);</span><br>       79-&gt;N:  <span style="background-color: white">      				}</span><br>      80-&gt;80:  <span style="background-color: white">      				break;</span><br>      81-&gt;81:  <span style="background-color: white">      			case 3:</span><br>      82-&gt;82:  <span style="background-color: white">      				if (this.branch.getStatus() != 3) {</span><br>      83-&gt;83:  <span style="background-color: white">      					this.branch.setStatus(2);</span><br>       84-&gt;N:  <span style="background-color: white">      				}</span><br>      85-&gt;85:  <span style="background-color: white">      				this.branch.setParam(branch.getParam());</span><br>       86-&gt;N:  <span style="background-color: white">      </span><br>       87-&gt;N:  <span style="background-color: white">      			}</span><br>       88-&gt;N:  <span style="background-color: white">      			return this.branch;</span><br>       89-&gt;N:  <span style="background-color: white">      		}</span><br>       90-&gt;N:  <span style="background-color: white">      </span><br>      91-&gt;91:  <span style="background-color: white">      		if (bs &lt; 0) {</span><br>       92-&gt;N:  <span style="background-color: white">      			// 如果数组内元素接近于最大值直接数组定位，rate是内存和速度的一个平衡</span><br>      93-&gt;93:  <span style="background-color: white">      			if (branches != null &amp;&amp; branches.length &gt;= MAX_SIZE * rate) {</span><br>      94-&gt;94:  <span style="background-color: white">      				SmartForest
       <t>
        [] tempBranches = new SmartForest[MAX_SIZE];
       </t></span><br>      95-&gt;95:  <span style="background-color: white">      				for (SmartForest
       <t>
         b : branches) {
       </t></span><br>      96-&gt;96:  <span style="background-color: white">      					tempBranches[b.getC()] = b;</span><br>       97-&gt;N:  <span style="background-color: white">      				}</span><br>      98-&gt;98:  <span style="background-color: white">      				tempBranches[branch.getC()] = branch;</span><br>      99-&gt;99:  <span style="background-color: white">      				branches = null;</span><br>    100-&gt;100:  <span style="background-color: white">      				branches = tempBranches;</span><br>      101-&gt;N:  <span style="background-color: white">      			} else {</span><br>    102-&gt;102:  <span style="background-color: white">      				SmartForest
       <t>
        [] newBranches = new SmartForest[branches.length + 1];
       </t></span><br>    103-&gt;103:  <span style="background-color: white">      				int insert = -(bs + 1);</span><br>    104-&gt;104:  <span style="background-color: white">      				System.arraycopy(this.branches, 0, newBranches, 0, insert);</span><br>    105-&gt;105:  <span style="background-color: white">      				System.arraycopy(branches, insert, newBranches, insert + 1, branches.length - insert);</span><br>    106-&gt;106:  <span style="background-color: white">      				newBranches[insert] = branch;</span><br>    107-&gt;107:  <span style="background-color: white">      				this.branches = newBranches;</span><br>      108-&gt;N:  <span style="background-color: white">      			}</span><br>      109-&gt;N:  <span style="background-color: white">      </span><br>      110-&gt;N:  <span style="background-color: white">      		}</span><br>    111-&gt;111:  <span style="background-color: white">      		return branch;</span><br>      112-&gt;N:  <span style="background-color: white">      	}</span><br>      113-&gt;N:  <span style="background-color: white">      </span><br>    114-&gt;114:  <span style="background-color: white">      	public int getIndex(char c) {</span><br>    115-&gt;115:  <span style="background-color: white">      		if (branches == null) {</span><br>    116-&gt;116:  <span style="background-color: white">      			return -1;</span><br>      117-&gt;N:  <span style="background-color: white">      		}</span><br>    118-&gt;118:  <span style="background-color: white">      		if (branches.length == MAX_SIZE) {</span><br>    119-&gt;119:  <span style="background-color: white">      			return c;</span><br>      120-&gt;N:  <span style="background-color: white">      		}</span><br>    121-&gt;121:  <span style="background-color: white">      		int i = Arrays.binarySearch(this.branches, new SmartForest
       <t>
        (c));
       </t></span><br>    122-&gt;122:  <span style="background-color: white">      		return i;</span><br>      123-&gt;N:  <span style="background-color: white">      	}</span><br>      124-&gt;N:  <span style="background-color: white">      </span><br>      125-&gt;N:  <span style="background-color: white">      	/**</span><br>      126-&gt;N:  <span style="background-color: white">      	 * 二分查找是否包含</span><br>      127-&gt;N:  <span style="background-color: white">      	 *</span><br>      128-&gt;N:  <span style="background-color: white">      	 * @param c</span><br>      129-&gt;N:  <span style="background-color: white">      	 * @return</span><br>      130-&gt;N:  <span style="background-color: white">      	 */</span><br>    131-&gt;131:  <span style="background-color: white">      	public boolean contains(char c) {</span><br>    132-&gt;132:  <span style="background-color: white">      		if (this.branches == null) {</span><br>    133-&gt;133:  <span style="background-color: white">      			return false;</span><br>      134-&gt;N:  <span style="background-color: white">      		}</span><br>    135-&gt;135:  <span style="background-color: white">      		return Arrays.binarySearch(this.branches, c) &gt; -1;</span><br>      136-&gt;N:  <span style="background-color: white">      	}</span><br>      137-&gt;N:  <span style="background-color: white">      </span><br>    138-&gt;138:  <span style="background-color: white">      	public int compareTo(char c) {</span><br>    139-&gt;139:  <span style="background-color: white">      		if (this.c &gt; c) {</span><br>    140-&gt;140:  <span style="background-color: white">      			return 1;</span><br>      141-&gt;N:  <span style="background-color: white">      		}</span><br>    142-&gt;142:  <span style="background-color: white">      		if (this.c &lt; c) {</span><br>    143-&gt;143:  <span style="background-color: white">      			return -1;</span><br>      144-&gt;N:  <span style="background-color: white">      		}</span><br>    145-&gt;145:  <span style="background-color: white">      		return 0;</span><br>      146-&gt;N:  <span style="background-color: white">      	}</span><br>      147-&gt;N:  <span style="background-color: white">      </span><br>    148-&gt;148:  <span style="background-color: white">      	public boolean equals(char c) {</span><br>    149-&gt;149:  <span style="background-color: white">      		return this.c == c;</span><br>      150-&gt;N:  <span style="background-color: white">      	}</span><br>      151-&gt;N:  <span style="background-color: white">      </span><br>    152-&gt;152:  <span style="background-color: white">      	@Override</span><br>    153-&gt;153:  <span style="background-color: white">      	public int hashCode() {</span><br>      154-&gt;N:  <span style="background-color: white">      		return this.c;</span><br>      155-&gt;N:  <span style="background-color: white">      	}</span><br>      156-&gt;N:  <span style="background-color: white">      </span><br>    157-&gt;157:  <span style="background-color: white">      	public byte getStatus() {</span><br>      158-&gt;N:  <span style="background-color: white">      		return this.status;</span><br>      159-&gt;N:  <span style="background-color: white">      	}</span><br>      160-&gt;N:  <span style="background-color: white">      </span><br>    161-&gt;161:  <span style="background-color: white">      	public void setStatus(int status) {</span><br>    162-&gt;162:  <span style="background-color: white">      		this.status = (byte) status;</span><br>      163-&gt;N:  <span style="background-color: white">      	}</span><br>      164-&gt;N:  <span style="background-color: white">      </span><br>    165-&gt;165:  <span style="background-color: white">      	public char getC() {</span><br>      166-&gt;N:  <span style="background-color: white">      		return this.c;</span><br>      167-&gt;N:  <span style="background-color: white">      	}</span><br>      168-&gt;N:  <span style="background-color: white">      </span><br>    169-&gt;169:  <span style="background-color: white">      	public T getParam() {</span><br>      170-&gt;N:  <span style="background-color: white">      		return this.param;</span><br>      171-&gt;N:  <span style="background-color: white">      	}</span><br>      172-&gt;N:  <span style="background-color: white">      </span><br>    173-&gt;173:  <span style="background-color: white">      	public void setParam(T param) {</span><br>    174-&gt;174:  <span style="background-color: white">      		this.param = param;</span><br>      175-&gt;N:  <span style="background-color: white">      	}</span><br>      176-&gt;N:  <span style="background-color: white">      </span><br>      177-&gt;N:  <span style="background-color: white">      	/**</span><br>      178-&gt;N:  <span style="background-color: white">      	 * 增加新词</span><br>      179-&gt;N:  <span style="background-color: white">      	 *</span><br>      180-&gt;N:  <span style="background-color: white">      	 * @param</span><br>      181-&gt;N:  <span style="background-color: white">      	 */</span><br>    182-&gt;182:  <span style="background-color: white">      	public void add(String keyWord, T t) {</span><br>    183-&gt;183:  <span style="background-color: white">      		SmartForest
       <t>
         tempBranch = this;
       </t></span><br>    184-&gt;184:  <span style="background-color: white">      		for (int i = 0; i &lt; keyWord.length(); i++) {</span><br>    185-&gt;185:  <span style="background-color: white">      			if (keyWord.length() == i + 1) {</span><br>    186-&gt;186:  <span style="background-color: white">      				tempBranch.add(new SmartForest
       <t>
        (keyWord.charAt(i), 3, t));
       </t></span><br>      187-&gt;N:  <span style="background-color: white">      			} else {</span><br>    188-&gt;188:  <span style="background-color: white">      				tempBranch.add(new SmartForest
       <t>
        (keyWord.charAt(i), 1, null));
       </t></span><br>      189-&gt;N:  <span style="background-color: white">      			}</span><br>    190-&gt;190:  <span style="background-color: white">      			tempBranch = tempBranch.branches[tempBranch.getIndex(keyWord.charAt(i))];</span><br>      191-&gt;N:  <span style="background-color: white">      		}</span><br>      192-&gt;N:  <span style="background-color: white">      	}</span><br>      193-&gt;N:  <span style="background-color: white">      </span><br>      194-&gt;N:  <span style="background-color: white">      	/**</span><br>      195-&gt;N:  <span style="background-color: white">      	 * 增加一个元素到节点</span><br>      196-&gt;N:  <span style="background-color: white">      	 * </span><br>      197-&gt;N:  <span style="background-color: white">      	 * @param keyWord</span><br>      198-&gt;N:  <span style="background-color: white">      	 * @param t</span><br>      199-&gt;N:  <span style="background-color: white">      	 */</span><br>    200-&gt;200:  <span style="background-color: white">      	public void addBranch(String keyWord, T t) {</span><br>    201-&gt;201:  <span style="background-color: white">      		this.add(keyWord, t);</span><br>      202-&gt;N:  <span style="background-color: white">      	}</span><br>      203-&gt;N:  <span style="background-color: white">      </span><br>    204-&gt;204:  <span style="background-color: white">      	@Override</span><br>    205-&gt;205:  <span style="background-color: white">      	public int compareTo(SmartForest
       <t>
         o) {
       </t></span><br>    206-&gt;206:  <span style="background-color: white">      		if (this.c &gt; o.c) {</span><br>    207-&gt;207:  <span style="background-color: white">      			return 1;</span><br>      208-&gt;N:  <span style="background-color: white">      		}</span><br>    209-&gt;209:  <span style="background-color: white">      		if (this.c &lt; o.c) {</span><br>    210-&gt;210:  <span style="background-color: white">      			return -1;</span><br>      211-&gt;N:  <span style="background-color: white">      		}</span><br>    212-&gt;212:  <span style="background-color: white">      		return 0;</span><br>      213-&gt;N:  <span style="background-color: white">      	}</span><br>      214-&gt;N:  <span style="background-color: white">      </span><br>    215-&gt;215:  <span style="background-color: white">      	public SmartForest
       <t>
         get(char c) {
       </t></span><br>    216-&gt;216:  <span style="background-color: white">      		return getBranch(c);</span><br>      217-&gt;N:  <span style="background-color: white">      	}</span><br>      218-&gt;N:  <span style="background-color: white">      </span><br>    219-&gt;219:  <span style="background-color: white">      	public SmartForest
       <t>
         getBranch(char c) {
       </t></span><br>    220-&gt;220:  <span style="background-color: white">      		int index = getIndex(c);</span><br>    221-&gt;221:  <span style="background-color: white">      		if (index &lt; 0) {</span><br>    222-&gt;222:  <span style="background-color: white">      			return null;</span><br>      223-&gt;N:  <span style="background-color: white">      		} else {</span><br>    224-&gt;224:  <span style="background-color: white">      			return branches[index];</span><br>      225-&gt;N:  <span style="background-color: white">      		}</span><br>      226-&gt;N:  <span style="background-color: white">      	}</span><br>      227-&gt;N:  <span style="background-color: white">      </span><br>      228-&gt;N:  <span style="background-color: white">      	/**</span><br>      229-&gt;N:  <span style="background-color: white">      	 * 根据一个词获得所取的参数,没有就返回null</span><br>      230-&gt;N:  <span style="background-color: white">      	 *</span><br>      231-&gt;N:  <span style="background-color: white">      	 * @param keyWord</span><br>      232-&gt;N:  <span style="background-color: white">      	 */</span><br>    233-&gt;233:  <span style="background-color: white">      	public SmartForest
       <t>
         getBranch(String keyWord) {
       </t></span><br>    234-&gt;234:  <span style="background-color: white">      		SmartForest
       <t>
         tempBranch = this;
       </t></span><br>    235-&gt;235:  <span style="background-color: white">      		int index = 0;</span><br>    236-&gt;236:  <span style="background-color: white">      		for (int j = 0; j &lt; keyWord.length(); j++) {</span><br>    237-&gt;237:  <span style="background-color: white">      			index = tempBranch.getIndex(keyWord.charAt(j));</span><br>    238-&gt;238:  <span style="background-color: white">      			if (index &lt; 0) {</span><br>    239-&gt;239:  <span style="background-color: white">      				return null;</span><br>      240-&gt;N:  <span style="background-color: white">      			}</span><br>    241-&gt;241:  <span style="background-color: white">      			if ((tempBranch = tempBranch.branches[index]) == null) {</span><br>    242-&gt;242:  <span style="background-color: white">      				return null;</span><br>      243-&gt;N:  <span style="background-color: white">      			}</span><br>      244-&gt;N:  <span style="background-color: white">      </span><br>      245-&gt;N:  <span style="background-color: white">      		}</span><br>    246-&gt;246:  <span style="background-color: white">      		return tempBranch;</span><br>      247-&gt;N:  <span style="background-color: white">      	}</span><br>      248-&gt;N:  <span style="background-color: white">      </span><br>      249-&gt;N:  <span style="background-color: white">      	/**</span><br>      250-&gt;N:  <span style="background-color: white">      	 * 根据一个词获得所取的参数,没有就返回null</span><br>      251-&gt;N:  <span style="background-color: white">      	 *</span><br>      252-&gt;N:  <span style="background-color: white">      	 * @param chars</span><br>      253-&gt;N:  <span style="background-color: white">      	 */</span><br>    254-&gt;254:  <span style="background-color: white">      	public SmartForest
       <t>
         getBranch(char[] chars) {
       </t></span><br>    255-&gt;255:  <span style="background-color: white">      		SmartForest
       <t>
         tempBranch = this;
       </t></span><br>    256-&gt;256:  <span style="background-color: white">      		int index = 0;</span><br>    257-&gt;257:  <span style="background-color: white">      		for (int j = 0; j &lt; chars.length; j++) {</span><br>    258-&gt;258:  <span style="background-color: white">      			index = tempBranch.getIndex(chars[j]);</span><br>    259-&gt;259:  <span style="background-color: white">      			if (index &lt; 0) {</span><br>    260-&gt;260:  <span style="background-color: white">      				return null;</span><br>      261-&gt;N:  <span style="background-color: white">      			}</span><br>    262-&gt;262:  <span style="background-color: white">      			if ((tempBranch = tempBranch.branches[index]) == null) {</span><br>    263-&gt;263:  <span style="background-color: white">      				return null;</span><br>      264-&gt;N:  <span style="background-color: white">      			}</span><br>      265-&gt;N:  <span style="background-color: white">      </span><br>      266-&gt;N:  <span style="background-color: white">      		}</span><br>    267-&gt;267:  <span style="background-color: white">      		return tempBranch;</span><br>      268-&gt;N:  <span style="background-color: white">      	}</span><br>      269-&gt;N:  <span style="background-color: white">      </span><br>    270-&gt;270:  <span style="background-color: white">      	public SmartGetWord
       <t>
         getWord(String str) {
       </t></span><br>    271-&gt;271:  <span style="background-color: white">      		return getWord(str.toCharArray());</span><br>      272-&gt;N:  <span style="background-color: white">      	}</span><br>      273-&gt;N:  <span style="background-color: white">      </span><br>      274-&gt;N:  <span style="background-color: white">      	/**</span><br>      275-&gt;N:  <span style="background-color: white">      	 * 得到抽詞器</span><br>      276-&gt;N:  <span style="background-color: white">      	 * </span><br>      277-&gt;N:  <span style="background-color: white">      	 * @param chars</span><br>      278-&gt;N:  <span style="background-color: white">      	 * @return</span><br>      279-&gt;N:  <span style="background-color: white">      	 */</span><br>    280-&gt;280:  <span style="background-color: white">      	public SmartGetWord
       <t>
         getWord(char[] chars) {
       </t></span><br>    281-&gt;281:  <span style="background-color: white">      		return new SmartGetWord
       <t>
        (this, chars);
       </t></span><br>      282-&gt;N:  <span style="background-color: white">      	}</span><br>      283-&gt;N:  <span style="background-color: white">      </span><br>      284-&gt;N:  <span style="background-color: white">      	/**</span><br>      285-&gt;N:  <span style="background-color: white">      	 * 取得所有的分支</span><br>      286-&gt;N:  <span style="background-color: white">      	 * </span><br>      287-&gt;N:  <span style="background-color: white">      	 * @return</span><br>      288-&gt;N:  <span style="background-color: white">      	 */</span><br>    289-&gt;289:  <span style="background-color: white">      	public SmartForest
       <t>
        [] getBranches() {
       </t></span><br>      290-&gt;N:  <span style="background-color: white">      		return branches;</span><br>      291-&gt;N:  <span style="background-color: white">      	}</span><br>      292-&gt;N:  <span style="background-color: white">      </span><br>      293-&gt;N:  <span style="background-color: white">      	/**</span><br>      294-&gt;N:  <span style="background-color: white">      	 * 删除一个词语</span><br>      295-&gt;N:  <span style="background-color: white">      	 * </span><br>      296-&gt;N:  <span style="background-color: white">      	 * @param string</span><br>      297-&gt;N:  <span style="background-color: white">      	 */</span><br>    298-&gt;298:  <span style="background-color: white">      	public void remove(String word) {</span><br>    299-&gt;299:  <span style="background-color: white">      		getBranch(word).status = 1;</span><br>    300-&gt;300:  <span style="background-color: white">      		getBranch(word).param = null ;</span><br>      301-&gt;N:  <span style="background-color: white">      	}</span><br>      302-&gt;N:  <span style="background-color: white">      </span><br>      303-&gt;N:  <span style="background-color: white">      	/**</span><br>      304-&gt;N:  <span style="background-color: white">      	 * 清空</span><br>      305-&gt;N:  <span style="background-color: white">      	 */</span><br>    306-&gt;306:  <span style="background-color: white">      	@SuppressWarnings("unchecked")</span><br>    307-&gt;307:  <span style="background-color: white">      	public void clear() {</span><br>    308-&gt;308:  <span style="background-color: white">      		branches = new SmartForest[MAX_SIZE];</span><br>      309-&gt;N:  <span style="background-color: white">      	}</span><br>      310-&gt;N:  <span style="background-color: white">      </span><br>      311-&gt;N:  <span style="background-color: white">      	/**</span><br>      312-&gt;N:  <span style="background-color: white">      	 * 将树转换为map</span><br>      313-&gt;N:  <span style="background-color: white">      	 * </span><br>      314-&gt;N:  <span style="background-color: white">      	 * @return map
       <string,object></string,object></span><br>      315-&gt;N:  <span style="background-color: white">      	 */</span><br>    316-&gt;316:  <span style="background-color: white">      	public Map
       <string, t>
         toMap() {
       </string,></span><br>      317-&gt;N:  <span style="background-color: white">      </span><br>    318-&gt;318:  <span style="background-color: white">      		HashMap
       <string, t>
         result = new HashMap
        <string, t>
         ();
        </string,>
       </string,></span><br>      319-&gt;N:  <span style="background-color: white">      </span><br>    320-&gt;320:  <span style="background-color: white">      		if (this.branches == null) {</span><br>    321-&gt;321:  <span style="background-color: white">      			return result;</span><br>      322-&gt;N:  <span style="background-color: white">      		}</span><br>      323-&gt;N:  <span style="background-color: white">      </span><br>    324-&gt;324:  <span style="background-color: white">      		putMap(result, "", this.branches);</span><br>      325-&gt;N:  <span style="background-color: white">      </span><br>    326-&gt;326:  <span style="background-color: white">      		return result;</span><br>      327-&gt;N:  <span style="background-color: white">      	}</span><br>      328-&gt;N:  <span style="background-color: white">      </span><br>      329-&gt;N:  <span style="background-color: white">      	</span><br>    330-&gt;330:  <span style="background-color: white">      	private void putMap(HashMap
       <string, t>
         result, String pre, SmartForest
        <t>
         [] branches) {
        </t>
       </string,></span><br>    331-&gt;331:  <span style="background-color: white">      		if (branches == null) {</span><br>    332-&gt;332:  <span style="background-color: white">      			return;</span><br>      333-&gt;N:  <span style="background-color: white">      		}</span><br>      334-&gt;N:  <span style="background-color: white">      </span><br>    335-&gt;335:  <span style="background-color: white">      		String key = null;</span><br>    336-&gt;336:  <span style="background-color: white">      		SmartForest
       <t>
         sf = null;
       </t></span><br>    337-&gt;337:  <span style="background-color: white">      		for (int i = 0; i &lt; branches.length; i++) {</span><br>    338-&gt;338:  <span style="background-color: white">      			sf = branches[i];</span><br>    339-&gt;339:  <span style="background-color: white">      			if (sf == null) {</span><br>    340-&gt;340:  <span style="background-color: white">      				continue;</span><br>      341-&gt;N:  <span style="background-color: white">      			}</span><br>    342-&gt;342:  <span style="background-color: white">      			key = pre + branches[i].c;</span><br>    343-&gt;343:  <span style="background-color: white">      			if (branches[i].getStatus() == 3) {</span><br>    344-&gt;344:  <span style="background-color: white">      				result.put(key, branches[i].getParam());</span><br>    345-&gt;345:  <span style="background-color: white">      			} else if (branches[i].getStatus() == 2) {</span><br>    346-&gt;346:  <span style="background-color: white">      				result.put(key, branches[i].getParam());</span><br>    347-&gt;347:  <span style="background-color: white">      				putMap(result, key, sf.branches);</span><br>      348-&gt;N:  <span style="background-color: white">      			} else {</span><br>    349-&gt;349:  <span style="background-color: white">      				putMap(result, key, sf.branches);</span><br>      350-&gt;N:  <span style="background-color: white">      			}</span><br>      351-&gt;N:  <span style="background-color: white">      		}</span><br>      352-&gt;N:  <span style="background-color: white">      	}</span><br>      353-&gt;N:  <span style="background-color: white">      </span><br>      354-&gt;N:  <span style="background-color: white">      }</span><br></pre> </code> 
   </div> 
  </div>  
 </body>
</html>